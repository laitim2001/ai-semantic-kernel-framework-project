# Azure éƒ¨ç½²å®Œæ•´ TODO æ¸…å–®

**å‰µå»ºæ—¥æœŸ**: 2025-11-20
**ç¸½è¨ˆ**: 39 å€‹æ–‡ä»¶/ä¿®æ”¹é …ç›®
**å·²å®Œæˆ**: 9 å€‹ (23%)
**å¾…å®Œæˆ**: 30 å€‹ (77%)

---

## ğŸ“Š ç¸½è¦½

| éšæ®µ | æ–‡ä»¶æ•¸ | å·²å®Œæˆ | å¾…å®Œæˆ | å„ªå…ˆç´š | é è¨ˆæ™‚é–“ |
|------|--------|--------|--------|--------|---------|
| éšæ®µ 1 | 3 | 3 | 0 | âœ… å®Œæˆ | - |
| éšæ®µ 2.1 | 7 | 7 | 0 | âœ… å®Œæˆ | - |
| éšæ®µ 2.2 | 2 | 0 | 2 | ğŸŸ¢ ä½ | 1h |
| éšæ®µ 3 | 4 | 0 | 4 | ğŸ”´ é—œéµ | 6-8h |
| éšæ®µ 4 | 2 | 0 | 2 | ğŸŸ¢ ä½ | 2-3h |
| éšæ®µ 5 | 6 | 0 | 6 | ğŸŸ¡ é«˜ | 4-6h |
| éšæ®µ 6 | 3 | 0 | 3 | ğŸŸ¢ ä¸­ | 4-5h |
| éšæ®µ 7 | 5 | 0 | 5 | ğŸŸ¡ é«˜ | 3-4h |
| éšæ®µ 8 | 7 | 0 | 7 | ğŸŸ¡ é«˜ | 3-4h |
| éšæ®µ 9 | 3 | 0 | 3 | ğŸŸ¢ ä½ | 2-3h |
| éšæ®µ 10 | 4 | 0 | 4 | âšª å¯é¸ | 4-6h |

**ç¸½è¨ˆé è¨ˆæ™‚é–“**: 29-42 å°æ™‚

---

## âœ… éšæ®µ 1: Docker é…ç½® (å·²å®Œæˆ)

### å·²å®Œæˆæ–‡ä»¶ (3/3)

- [x] `docker/Dockerfile` - ç”Ÿç”¢ç’°å¢ƒ Dockerfile
- [x] `docker/.dockerignore` - Docker build æ’é™¤æ–‡ä»¶
- [x] `apps/web/next.config.mjs` - æ·»åŠ  `output: 'standalone'`

**å®Œæˆæ™‚é–“**: 2025-11-20
**ç‹€æ…‹**: âœ… 100% å®Œæˆ

---

## âœ… éšæ®µ 2.1: .azure/ æ ¸å¿ƒæ–‡ä»¶ (å·²å®Œæˆ)

### å·²å®Œæˆæ–‡ä»¶ (7/7)

- [x] `.azure/README.md` - Azure éƒ¨ç½²ç¸½è¦½
- [x] `.azure/environments/dev.env.example` - Dev ç’°å¢ƒé…ç½®ç¯„ä¾‹
- [x] `.azure/environments/staging.env.example` - Staging ç’°å¢ƒé…ç½®ç¯„ä¾‹
- [x] `.azure/environments/prod.env.example` - Prod ç’°å¢ƒé…ç½®ç¯„ä¾‹
- [x] `.azure/docs/service-principal-setup.md` - SP å®Œæ•´è¨­ç½®æŒ‡å—
- [x] `docs/deployment/azure-deployment-plan.md` - å®Œæ•´éƒ¨ç½²è¦åŠƒ
- [x] `.gitignore` - æ›´æ–°å…è¨± .azure/ é…ç½®æäº¤

**å®Œæˆæ™‚é–“**: 2025-11-20
**ç‹€æ…‹**: âœ… 100% å®Œæˆ

---

## â³ éšæ®µ 2.2: docker/ è¼”åŠ©æ–‡ä»¶ (å¾…å®Œæˆ)

### å¾…å®Œæˆæ–‡ä»¶ (0/2)

- [ ] `docker/Dockerfile.dev` - é–‹ç™¼ç’°å¢ƒ Dockerfile
  - **ç›®çš„**: æœ¬åœ°é–‹ç™¼ç’°å¢ƒå¿«é€Ÿæ§‹å»º
  - **å…§å®¹**: ç°¡åŒ–ç‰ˆ Dockerfileï¼Œæ”¯æŒç†±é‡è¼‰
  - **é è¨ˆæ™‚é–“**: 30 åˆ†é˜

- [ ] `docker/docker-compose.azure.yml` - Azure æ¸¬è©¦ç”¨ compose
  - **ç›®çš„**: æœ¬åœ°æ¨¡æ“¬ Azure ç’°å¢ƒ
  - **å…§å®¹**: åŒ…å« Azurite (Blob Storage æ¨¡æ“¬å™¨)
  - **é è¨ˆæ™‚é–“**: 30 åˆ†é˜

**å„ªå…ˆç´š**: ğŸŸ¢ ä½ (é–‹ç™¼è¼”åŠ©å·¥å…·)
**é è¨ˆæ™‚é–“**: 1 å°æ™‚
**ä¾è³´**: ç„¡

---

## â³ éšæ®µ 3: Azure Blob Storage å¯¦ä½œ (å¾…å®Œæˆ)

### å¾…å®Œæˆæ–‡ä»¶ (0/4)

#### 1. æ–°å»ºæ–‡ä»¶ (1)

- [ ] `apps/web/src/lib/azure-storage.ts` - Blob Storage æœå‹™
  - **ç›®çš„**: å°è£ Azure Blob Storage SDK
  - **åŠŸèƒ½**:
    - `uploadToBlob(container, fileName, buffer)` - ä¸Šå‚³æ–‡ä»¶
    - `deleteFromBlob(container, fileName)` - åˆªé™¤æ–‡ä»¶
    - `getBlobUrl(container, fileName)` - ç²å–è¨ªå• URL
    - `listBlobs(container, prefix)` - åˆ—å‡ºæ–‡ä»¶
  - **é è¨ˆæ™‚é–“**: 2-3 å°æ™‚

#### 2. ä¿®æ”¹æ–‡ä»¶ (3)

- [ ] `apps/web/src/app/api/upload/quote/route.ts` - é‡æ§‹å ±åƒ¹ä¸Šå‚³
  - **ä¿®æ”¹é»**: æ·»åŠ ç’°å¢ƒæª¢æ¸¬ï¼Œç”Ÿç”¢ç’°å¢ƒä½¿ç”¨ Blob Storage
  - **é è¨ˆæ™‚é–“**: 1.5 å°æ™‚

- [ ] `apps/web/src/app/api/upload/invoice/route.ts` - é‡æ§‹ç™¼ç¥¨ä¸Šå‚³
  - **ä¿®æ”¹é»**: åŒä¸Š
  - **é è¨ˆæ™‚é–“**: 1.5 å°æ™‚

- [ ] `apps/web/src/app/api/upload/proposal/route.ts` - é‡æ§‹ææ¡ˆä¸Šå‚³
  - **ä¿®æ”¹é»**: åŒä¸Š
  - **é è¨ˆæ™‚é–“**: 1.5 å°æ™‚

#### 3. ä¾è³´å®‰è£

```bash
pnpm add @azure/storage-blob @azure/identity --filter @itpm/web
```

**å„ªå…ˆç´š**: ğŸ”´ **é—œéµ - éƒ¨ç½²é˜»æ–·å•é¡Œ**
**é è¨ˆæ™‚é–“**: 6-8 å°æ™‚
**ä¾è³´**: ç„¡
**å‚™è¨»**: å¿…é ˆåœ¨éƒ¨ç½²å‰å®Œæˆï¼Œå¦å‰‡æ–‡ä»¶æœƒä¸Ÿå¤±

---

## â³ éšæ®µ 4: AI åŠ©æ‰‹éƒ¨ç½² Prompts (å¾…å®Œæˆ)

### å¾…å®Œæˆæ–‡ä»¶ (0/2)

- [ ] `claudedocs/6-ai-assistant/prompts/SITUATION-6-AZURE-DEPLOY.md`
  - **ç›®çš„**: Azure éƒ¨ç½²æµç¨‹ AI æŒ‡å¼•
  - **å…§å®¹**:
    - éƒ¨ç½²å‰æª¢æŸ¥æ¸…å–®
    - ç’°å¢ƒé…ç½®é©—è­‰
    - éƒ¨ç½²æ­¥é©ŸæŒ‡å¼•
    - å¸¸è¦‹å•é¡Œå¿«é€Ÿè§£æ±º
    - éƒ¨ç½²å¾Œé©—è­‰
  - **é è¨ˆæ™‚é–“**: 1.5 å°æ™‚

- [ ] `claudedocs/6-ai-assistant/prompts/SITUATION-7-AZURE-TROUBLESHOOT.md`
  - **ç›®çš„**: Azure å•é¡Œæ’æŸ¥ AI æŒ‡å¼•
  - **å…§å®¹**:
    - éƒ¨ç½²å¤±æ•—è¨ºæ–·æµç¨‹
    - æ‡‰ç”¨é‹è¡Œç•°å¸¸æ’æŸ¥
    - æ—¥èªŒæŸ¥è©¢å‘½ä»¤é›†
    - å›æ»¾æ“ä½œæŒ‡å¼•
    - æ€§èƒ½å•é¡Œè¨ºæ–·
  - **é è¨ˆæ™‚é–“**: 1.5 å°æ™‚

**å„ªå…ˆç´š**: ğŸŸ¢ ä½ (è¼”åŠ©å·¥å…·)
**é è¨ˆæ™‚é–“**: 2-3 å°æ™‚
**ä¾è³´**: éšæ®µ 5, 7 å®Œæˆå¾Œæ›´æº–ç¢º

---

## â³ éšæ®µ 5: Azure è³‡æºé…ç½®è…³æœ¬ (å¾…å®Œæˆ)

### å¾…å®Œæˆæ–‡ä»¶ (0/6)

- [ ] `.azure/scripts/01-setup-resources.sh`
  - **ç›®çš„**: å‰µå»º Azure è³‡æºç¾¤çµ„
  - **å…§å®¹**:
    - å‰µå»º resource group (dev/staging/prod)
    - è¨­ç½®æ¨™ç±¤ (Environment, Project, ManagedBy)
    - é©—è­‰è³‡æºç¾¤çµ„å‰µå»º
  - **é è¨ˆæ™‚é–“**: 30 åˆ†é˜

- [ ] `.azure/scripts/02-setup-database.sh`
  - **ç›®çš„**: é…ç½® PostgreSQL Flexible Server
  - **å…§å®¹**:
    - å‰µå»º PostgreSQL server
    - é…ç½®é˜²ç«ç‰†è¦å‰‡
    - å‰µå»ºæ•¸æ“šåº«
    - è¨­ç½®å‚™ä»½ç­–ç•¥ (ç”Ÿç”¢ç’°å¢ƒ)
    - è¼¸å‡ºé€£æ¥å­—ä¸²
  - **é è¨ˆæ™‚é–“**: 1 å°æ™‚

- [ ] `.azure/scripts/03-setup-storage.sh`
  - **ç›®çš„**: é…ç½® Azure Blob Storage
  - **å…§å®¹**:
    - å‰µå»º Storage Account
    - å‰µå»º 3 å€‹ containers (quotes, invoices, proposals)
    - é…ç½® CORS
    - è¨­ç½®è¨ªå•å±¤ç´š (Hot)
    - è¼¸å‡ºé€£æ¥å­—ä¸²
  - **é è¨ˆæ™‚é–“**: 1 å°æ™‚

- [ ] `.azure/scripts/04-setup-acr.sh`
  - **ç›®çš„**: é…ç½® Azure Container Registry
  - **å…§å®¹**:
    - å‰µå»º ACR
    - å•Ÿç”¨ Admin User
    - ç²å–ç™»å…¥æ†‘è­‰
    - è¼¸å‡º registry URL
  - **é è¨ˆæ™‚é–“**: 30 åˆ†é˜

- [ ] `.azure/scripts/05-setup-appservice.sh`
  - **ç›®çš„**: é…ç½® Azure App Service
  - **å…§å®¹**:
    - å‰µå»º App Service Plan
    - å‰µå»º Web App
    - é…ç½®å®¹å™¨è¨­ç½® (ACR integration)
    - å•Ÿç”¨ Managed Identity
    - é…ç½®ç’°å¢ƒè®Šæ•¸ (Key Vault å¼•ç”¨)
    - é…ç½®æ—¥èªŒ (Application Insights)
  - **é è¨ˆæ™‚é–“**: 1.5 å°æ™‚

- [ ] `.azure/scripts/06-deploy-app.sh`
  - **ç›®çš„**: éƒ¨ç½²æ‡‰ç”¨åˆ° Azure
  - **å…§å®¹**:
    - æ§‹å»º Docker é¡åƒ
    - æ¨™è¨˜é¡åƒç‰ˆæœ¬
    - æ¨é€åˆ° ACR
    - æ›´æ–° App Service é…ç½®
    - åŸ·è¡Œæ•¸æ“šåº«é·ç§»
    - å¥åº·æª¢æŸ¥
    - è¼¸å‡ºéƒ¨ç½²çµæœ
  - **é è¨ˆæ™‚é–“**: 1 å°æ™‚

**å„ªå…ˆç´š**: ğŸŸ¡ é«˜ (é¦–æ¬¡éƒ¨ç½²å¿…éœ€)
**é è¨ˆæ™‚é–“**: 4-6 å°æ™‚
**ä¾è³´**: éšæ®µ 3 å®Œæˆå¾Œ

---

## â³ éšæ®µ 6: CI/CD Pipeline (å¾…å®Œæˆ)

### å¾…å®Œæˆæ–‡ä»¶ (0/3)

- [ ] `.github/workflows/azure-deploy-dev.yml`
  - **ç›®çš„**: è‡ªå‹•éƒ¨ç½²åˆ° Dev ç’°å¢ƒ
  - **è§¸ç™¼**: push to develop åˆ†æ”¯
  - **æ­¥é©Ÿ**:
    1. Checkout code
    2. Setup Node.js 20
    3. Install dependencies
    4. Generate Prisma Client
    5. Build Docker image
    6. Login to ACR
    7. Push to ACR
    8. Deploy to App Service
    9. Run database migrations
    10. Health check
    11. Notify team
  - **é è¨ˆæ™‚é–“**: 1.5 å°æ™‚

- [ ] `.github/workflows/azure-deploy-staging.yml`
  - **ç›®çš„**: è‡ªå‹•éƒ¨ç½²åˆ° Staging ç’°å¢ƒ
  - **è§¸ç™¼**: create release-* tag
  - **é¡å¤–æ­¥é©Ÿ**:
    - Smoke tests
    - Performance tests
  - **é è¨ˆæ™‚é–“**: 1.5 å°æ™‚

- [ ] `.github/workflows/azure-deploy-prod.yml`
  - **ç›®çš„**: æ‰‹å‹•éƒ¨ç½²åˆ° Production ç’°å¢ƒ
  - **è§¸ç™¼**: manual (workflow_dispatch)
  - **é¡å¤–è¦æ±‚**:
    - Environment Secrets (éœ€å¯©æ‰¹)
    - 2 å€‹ Required Reviewers
    - Rollback plan
  - **é è¨ˆæ™‚é–“**: 2 å°æ™‚

**å„ªå…ˆç´š**: ğŸŸ¢ ä¸­ (è‡ªå‹•åŒ–éƒ¨ç½²)
**é è¨ˆæ™‚é–“**: 4-5 å°æ™‚
**ä¾è³´**: éšæ®µ 5 å®Œæˆä¸¦æ¸¬è©¦é€šé

---

## â³ éšæ®µ 7: éƒ¨ç½²æ–‡æª” (å¾…å®Œæˆ)

### å¾…å®Œæˆæ–‡ä»¶ (0/5)

- [ ] `docs/deployment/00-prerequisites.md`
  - **ç›®çš„**: éƒ¨ç½²å‰ç½®éœ€æ±‚æª¢æŸ¥æ¸…å–®
  - **å…§å®¹**:
    - Azure è¨‚é–±æª¢æŸ¥
    - å·¥å…·å®‰è£æ¸…å–® (Azure CLI, Docker, Node.js, pnpm)
    - æ¬Šé™é©—è­‰ (Subscription Contributor)
    - ç¶²çµ¡é€£æ¥æ¸¬è©¦
  - **é è¨ˆæ™‚é–“**: 30 åˆ†é˜

- [ ] `docs/deployment/01-first-time-setup.md`
  - **ç›®çš„**: é¦–æ¬¡éƒ¨ç½²å®Œæ•´æŒ‡å—
  - **å…§å®¹**:
    - æ­¥é©Ÿ 1: æº–å‚™ç’°å¢ƒè®Šæ•¸
    - æ­¥é©Ÿ 2: å‰µå»º Azure è³‡æº
    - æ­¥é©Ÿ 3: é…ç½® Service Principal
    - æ­¥é©Ÿ 4: æäº¤å¯†é‘°åˆ—è¡¨çµ¦ Infra Admin
    - æ­¥é©Ÿ 5: é…ç½® Managed Identity
    - æ­¥é©Ÿ 6: æ§‹å»ºå’Œæ¨é€ Docker é¡åƒ
    - æ­¥é©Ÿ 7: é¦–æ¬¡éƒ¨ç½²
    - æ­¥é©Ÿ 8: é©—è­‰éƒ¨ç½²
  - **é è¨ˆæ™‚é–“**: 1.5 å°æ™‚

- [ ] `docs/deployment/02-ci-cd-setup.md`
  - **ç›®çš„**: CI/CD é…ç½®æŒ‡å—
  - **å…§å®¹**:
    - GitHub Actions é…ç½®
    - Service Principal è¨­ç½®
    - GitHub Secrets é…ç½®
    - Environment Secrets (Production)
    - éƒ¨ç½²æµç¨‹æ¸¬è©¦
  - **é è¨ˆæ™‚é–“**: 1 å°æ™‚

- [ ] `docs/deployment/03-troubleshooting.md`
  - **ç›®çš„**: æ•…éšœæ’æŸ¥æ‰‹å†Š
  - **å…§å®¹**:
    - éƒ¨ç½²å¤±æ•—å¸¸è¦‹éŒ¯èª¤
    - æ‡‰ç”¨å•Ÿå‹•å¤±æ•—è¨ºæ–·
    - æ–‡ä»¶ä¸Šå‚³å•é¡Œæ’æŸ¥
    - èªè­‰å•é¡Œè¨ºæ–·
    - æ•¸æ“šåº«é€£æ¥å•é¡Œ
    - æ—¥èªŒæŸ¥è©¢æ–¹æ³•
    - æ€§èƒ½å•é¡Œè¨ºæ–·
  - **é è¨ˆæ™‚é–“**: 1 å°æ™‚

- [ ] `docs/deployment/04-rollback.md`
  - **ç›®çš„**: å›æ»¾ç¨‹åº
  - **å…§å®¹**:
    - Docker é¡åƒå›æ»¾
    - æ•¸æ“šåº«é·ç§»å›æ»¾
    - ç’°å¢ƒè®Šæ•¸å›æ»¾
    - ç·Šæ€¥æ¢å¾©æ­¥é©Ÿ
    - å›æ»¾å¾Œé©—è­‰
  - **é è¨ˆæ™‚é–“**: 30 åˆ†é˜

**å„ªå…ˆç´š**: ğŸŸ¡ é«˜ (é¦–æ¬¡éƒ¨ç½²å¿…éœ€å‰ 2 å€‹)
**é è¨ˆæ™‚é–“**: 3-4 å°æ™‚
**ä¾è³´**: éšæ®µ 5 å®Œæˆå¾Œ

---

## â³ éšæ®µ 8: å¯†é‘°åˆ—è¡¨å’Œè¼”åŠ©è…³æœ¬ (å¾…å®Œæˆ)

### å¾…å®Œæˆæ–‡ä»¶ (0/7)

#### æ–‡æª” (2)

- [ ] `docs/deployment/key-vault-secrets-list.md`
  - **ç›®çš„**: æä¾›çµ¦ Azure Infra Admin çš„å®Œæ•´å¯†é‘°åˆ—è¡¨
  - **å…§å®¹**:
    - 3 å€‹ç’°å¢ƒçš„å®Œæ•´å¯†é‘°åˆ—è¡¨
    - å¯†é‘°å‘½åè¦ç¯„ (ITPM-{ENV}-{SERVICE}-{KEY})
    - ç¯„ä¾‹å€¼æ ¼å¼
    - è¨ªå•æ¬Šé™éœ€æ±‚
    - Managed Identity é…ç½®è¦æ±‚
  - **é è¨ˆæ™‚é–“**: 1 å°æ™‚

- [ ] `docs/deployment/managed-identity-setup.md`
  - **ç›®çš„**: Managed Identity é…ç½®æŒ‡å—
  - **å…§å®¹**:
    - å•Ÿç”¨ Managed Identity æ­¥é©Ÿ
    - Key Vault è¨ªå•ç­–ç•¥è¨­ç½®
    - æ¬Šé™é©—è­‰æ–¹æ³•
    - æ•…éšœæ’æŸ¥
  - **é è¨ˆæ™‚é–“**: 1 å°æ™‚

#### è¼”åŠ©è…³æœ¬ (5)

- [ ] `scripts/deployment/pre-deploy-check.js`
  - **ç›®çš„**: éƒ¨ç½²å‰è‡ªå‹•æª¢æŸ¥
  - **æª¢æŸ¥é …**:
    - ç’°å¢ƒè®Šæ•¸å®Œæ•´æ€§
    - Docker é¡åƒæ§‹å»ºæˆåŠŸ
    - Prisma migrations ç‹€æ…‹
    - TypeScript ç·¨è­¯ç„¡éŒ¯èª¤
    - æ¸¬è©¦é€šé
  - **é è¨ˆæ™‚é–“**: 30 åˆ†é˜

- [ ] `scripts/deployment/migrate-to-blob.js`
  - **ç›®çš„**: é·ç§»ç¾æœ‰æ–‡ä»¶åˆ° Blob Storage
  - **åŠŸèƒ½**:
    - æƒæ public/uploads/
    - ä¸Šå‚³åˆ°å°æ‡‰ container
    - æ›´æ–°æ•¸æ“šåº«è·¯å¾‘
    - é©—è­‰é·ç§»æˆåŠŸ
  - **é è¨ˆæ™‚é–“**: 1 å°æ™‚

- [ ] `scripts/deployment/validate-env.js`
  - **ç›®çš„**: é©—è­‰ç’°å¢ƒè®Šæ•¸é…ç½®
  - **æª¢æŸ¥é …**:
    - å¿…è¦è®Šæ•¸å­˜åœ¨
    - Key Vault å¼•ç”¨æ ¼å¼æ­£ç¢º
    - è®Šæ•¸å€¼æ ¼å¼é©—è­‰
    - è¼¸å‡ºé©—è­‰å ±å‘Š
  - **é è¨ˆæ™‚é–“**: 30 åˆ†é˜

- [ ] `scripts/azure/create-service-principal.sh`
  - **ç›®çš„**: è‡ªå‹•åŒ–å‰µå»º Service Principal
  - **åŠŸèƒ½**:
    - å‰µå»º 4 å€‹ SP (æŒ‰ç’°å¢ƒå’Œç”¨é€”)
    - åˆ†é…æ­£ç¢ºè§’è‰²
    - è¼¸å‡º JSON æ†‘è­‰
    - ç”Ÿæˆ GitHub Secrets é…ç½®æŒ‡ä»¤
  - **é è¨ˆæ™‚é–“**: 30 åˆ†é˜

- [ ] `scripts/azure/rotate-secrets.sh`
  - **ç›®çš„**: è¼ªæ› Service Principal å¯†é‘°
  - **åŠŸèƒ½**:
    - é‡ç½® SP å¯†é‘°
    - ç”Ÿæˆæ–°çš„æ†‘è­‰ JSON
    - è¼¸å‡ºæ›´æ–°æŒ‡ä»¤
    - é©—è­‰æ–°å¯†é‘°å¯ç”¨
  - **é è¨ˆæ™‚é–“**: 30 åˆ†é˜

**å„ªå…ˆç´š**: ğŸŸ¡ é«˜ (å¯†é‘°åˆ—è¡¨) + ğŸŸ¢ ä½ (è¼”åŠ©è…³æœ¬)
**é è¨ˆæ™‚é–“**: 3-4 å°æ™‚
**ä¾è³´**: ç„¡ (å¯†é‘°åˆ—è¡¨å¯ç«‹å³å‰µå»º)

---

## â³ éšæ®µ 9: æ¸¬è©¦å’Œé©—è­‰å·¥å…· (å¾…å®Œæˆ)

### å¾…å®Œæˆæ–‡ä»¶ (0/3)

- [ ] `scripts/test-docker-build.sh`
  - **ç›®çš„**: æœ¬åœ°æ¸¬è©¦ Docker æ§‹å»º
  - **åŠŸèƒ½**:
    - æ§‹å»º Docker é¡åƒ
    - é‹è¡Œå®¹å™¨
    - å¥åº·æª¢æŸ¥
    - è¼¸å‡ºæ¸¬è©¦å ±å‘Š
  - **é è¨ˆæ™‚é–“**: 1 å°æ™‚

- [ ] `scripts/local-azure-test.sh`
  - **ç›®çš„**: æœ¬åœ°æ¨¡æ“¬ Azure ç’°å¢ƒ
  - **åŠŸèƒ½**:
    - å•Ÿå‹• Azurite (Blob Storage æ¨¡æ“¬å™¨)
    - é…ç½®æœ¬åœ°ç’°å¢ƒè®Šæ•¸
    - æ¸¬è©¦æ–‡ä»¶ä¸Šå‚³
    - é©—è­‰ Blob Storage åŠŸèƒ½
  - **é è¨ˆæ™‚é–“**: 1 å°æ™‚

- [ ] `docker/docker-compose.azure.yml`
  - **ç›®çš„**: Azure æ¸¬è©¦ç”¨ Docker Compose
  - **æœå‹™**:
    - Azurite (Blob Storage)
    - PostgreSQL (åŒç”Ÿç”¢ç‰ˆæœ¬)
    - Redis (å¯é¸)
    - App (Next.js)
  - **é è¨ˆæ™‚é–“**: 1 å°æ™‚

**å„ªå…ˆç´š**: ğŸŸ¢ ä½ (é–‹ç™¼è¼”åŠ©)
**é è¨ˆæ™‚é–“**: 2-3 å°æ™‚
**ä¾è³´**: éšæ®µ 3 å®Œæˆå¾Œ

---

## â³ éšæ®µ 10: Terraform IaC (å¯é¸)

### å¾…å®Œæˆæ–‡ä»¶ (0/4)

- [ ] `.azure/terraform/main.tf`
  - **ç›®çš„**: Terraform ä¸»é…ç½®æ–‡ä»¶
  - **å…§å®¹**: æ‰€æœ‰ Azure è³‡æºå®šç¾©
  - **é è¨ˆæ™‚é–“**: 2 å°æ™‚

- [ ] `.azure/terraform/variables.tf`
  - **ç›®çš„**: Terraform è®Šæ•¸å®šç¾©
  - **å…§å®¹**: ç’°å¢ƒã€ä½ç½®ã€SKU ç­‰è®Šæ•¸
  - **é è¨ˆæ™‚é–“**: 1 å°æ™‚

- [ ] `.azure/terraform/outputs.tf`
  - **ç›®çš„**: Terraform è¼¸å‡ºå®šç¾©
  - **å…§å®¹**: é€£æ¥å­—ä¸²ã€URL ç­‰è¼¸å‡º
  - **é è¨ˆæ™‚é–“**: 30 åˆ†é˜

- [ ] `.azure/terraform/README.md`
  - **ç›®çš„**: Terraform ä½¿ç”¨èªªæ˜
  - **å…§å®¹**: åˆå§‹åŒ–ã€applyã€destroy æŒ‡ä»¤
  - **é è¨ˆæ™‚é–“**: 30 åˆ†é˜

**å„ªå…ˆç´š**: âšª å¯é¸ (é€²éšåŠŸèƒ½)
**é è¨ˆæ™‚é–“**: 4-6 å°æ™‚
**ä¾è³´**: éšæ®µ 5 å®Œæˆä¸¦é©—è­‰å¾Œ
**å‚™è¨»**: å¯ä»¥ç”¨ Bash è…³æœ¬æ›¿ä»£ï¼Œä¸æ˜¯å¿…é ˆ

---

## ğŸ¯ å»ºè­°åŸ·è¡Œé †åº

### æ‰¹æ¬¡ 1: è§£æ±ºé˜»æ–·å•é¡Œ (6-8 å°æ™‚)

**å„ªå…ˆç´š**: ğŸ”´ é—œéµ

```
éšæ®µ 3: Blob Storage å¯¦ä½œ
â”œâ”€ apps/web/src/lib/azure-storage.ts
â”œâ”€ apps/web/src/app/api/upload/quote/route.ts
â”œâ”€ apps/web/src/app/api/upload/invoice/route.ts
â””â”€ apps/web/src/app/api/upload/proposal/route.ts
```

**ç›®æ¨™**: ä»£ç¢¼å¯ä»¥éƒ¨ç½²åˆ° Azure

---

### æ‰¹æ¬¡ 2: æº–å‚™é¦–æ¬¡éƒ¨ç½² (6-8 å°æ™‚)

**å„ªå…ˆç´š**: ğŸŸ¡ é«˜

```
éšæ®µ 8 (éƒ¨åˆ†): å¯†é‘°åˆ—è¡¨
â”œâ”€ docs/deployment/key-vault-secrets-list.md
â””â”€ docs/deployment/managed-identity-setup.md

éšæ®µ 5: Azure è³‡æºè…³æœ¬
â”œâ”€ .azure/scripts/01-setup-resources.sh
â”œâ”€ .azure/scripts/02-setup-database.sh
â”œâ”€ .azure/scripts/03-setup-storage.sh
â”œâ”€ .azure/scripts/04-setup-acr.sh
â”œâ”€ .azure/scripts/05-setup-appservice.sh
â””â”€ .azure/scripts/06-deploy-app.sh

éšæ®µ 7 (éƒ¨åˆ†): æ ¸å¿ƒéƒ¨ç½²æ–‡æª”
â”œâ”€ docs/deployment/00-prerequisites.md
â””â”€ docs/deployment/01-first-time-setup.md
```

**ç›®æ¨™**: å¯ä»¥æ‰‹å‹•å®Œæˆé¦–æ¬¡éƒ¨ç½²

---

### æ‰¹æ¬¡ 3: è‡ªå‹•åŒ–éƒ¨ç½² (7-9 å°æ™‚)

**å„ªå…ˆç´š**: ğŸŸ¢ ä¸­

```
éšæ®µ 6: CI/CD Pipeline
â”œâ”€ .github/workflows/azure-deploy-dev.yml
â”œâ”€ .github/workflows/azure-deploy-staging.yml
â””â”€ .github/workflows/azure-deploy-prod.yml

éšæ®µ 7 (éƒ¨åˆ†): CI/CD æ–‡æª”
â”œâ”€ docs/deployment/02-ci-cd-setup.md
â”œâ”€ docs/deployment/03-troubleshooting.md
â””â”€ docs/deployment/04-rollback.md
```

**ç›®æ¨™**: CI/CD è‡ªå‹•éƒ¨ç½²å®Œå…¨é‹ä½œ

---

### æ‰¹æ¬¡ 4: è¼”åŠ©å·¥å…· (7-10 å°æ™‚)

**å„ªå…ˆç´š**: ğŸŸ¢ ä½

```
éšæ®µ 2.2: Docker è¼”åŠ©
â”œâ”€ docker/Dockerfile.dev
â””â”€ docker/docker-compose.azure.yml

éšæ®µ 4: AI Prompts
â”œâ”€ claudedocs/6-ai-assistant/prompts/SITUATION-6-AZURE-DEPLOY.md
â””â”€ claudedocs/6-ai-assistant/prompts/SITUATION-7-AZURE-TROUBLESHOOT.md

éšæ®µ 8 (éƒ¨åˆ†): è¼”åŠ©è…³æœ¬
â”œâ”€ scripts/deployment/pre-deploy-check.js
â”œâ”€ scripts/deployment/migrate-to-blob.js
â”œâ”€ scripts/deployment/validate-env.js
â”œâ”€ scripts/azure/create-service-principal.sh
â””â”€ scripts/azure/rotate-secrets.sh

éšæ®µ 9: æ¸¬è©¦å·¥å…·
â”œâ”€ scripts/test-docker-build.sh
â”œâ”€ scripts/local-azure-test.sh
â””â”€ docker/docker-compose.azure.yml (é‡è¤‡)
```

**ç›®æ¨™**: é–‹ç™¼é«”é©—å„ªåŒ–

---

### æ‰¹æ¬¡ 5: é€²éšåŠŸèƒ½ (4-6 å°æ™‚)

**å„ªå…ˆç´š**: âšª å¯é¸

```
éšæ®µ 10: Terraform
â”œâ”€ .azure/terraform/main.tf
â”œâ”€ .azure/terraform/variables.tf
â”œâ”€ .azure/terraform/outputs.tf
â””â”€ .azure/terraform/README.md
```

**ç›®æ¨™**: Infrastructure as Code

---

## ğŸ“ˆ é‡Œç¨‹ç¢‘

### é‡Œç¨‹ç¢‘ 1: ä»£ç¢¼å°±ç·’ âœ…

- âœ… éšæ®µ 1 å®Œæˆ
- âœ… éšæ®µ 2.1 å®Œæˆ
- â³ éšæ®µ 3 å®Œæˆ â† **ç•¶å‰ç›®æ¨™**

**æ¨™æº–**: ä»£ç¢¼å¯ä»¥éƒ¨ç½²åˆ° Azureï¼Œæ–‡ä»¶ä¸æœƒä¸Ÿå¤±

---

### é‡Œç¨‹ç¢‘ 2: é¦–æ¬¡éƒ¨ç½²æˆåŠŸ ğŸ¯

- â³ éšæ®µ 5 å®Œæˆ
- â³ éšæ®µ 7 (éƒ¨åˆ†) å®Œæˆ
- â³ éšæ®µ 8 (å¯†é‘°) å®Œæˆ
- â³ æ‰‹å‹•éƒ¨ç½²æˆåŠŸ

**æ¨™æº–**: å¯ä»¥æ‰‹å‹•éƒ¨ç½²åˆ° Dev ç’°å¢ƒä¸¦æ­£å¸¸é‹è¡Œ

---

### é‡Œç¨‹ç¢‘ 3: CI/CD è‡ªå‹•åŒ– ğŸš€

- â³ éšæ®µ 6 å®Œæˆ
- â³ éšæ®µ 7 (å…¨éƒ¨) å®Œæˆ
- â³ è‡ªå‹•éƒ¨ç½²æ¸¬è©¦é€šé

**æ¨™æº–**: Push ä»£ç¢¼è‡ªå‹•éƒ¨ç½²åˆ° Devï¼Œæ‰‹å‹•éƒ¨ç½²åˆ° Production

---

### é‡Œç¨‹ç¢‘ 4: å®Œæ•´å·¥å…·éˆ ğŸ’¯

- â³ éšæ®µ 2.2 å®Œæˆ
- â³ éšæ®µ 4 å®Œæˆ
- â³ éšæ®µ 8 (å…¨éƒ¨) å®Œæˆ
- â³ éšæ®µ 9 å®Œæˆ

**æ¨™æº–**: é–‹ç™¼ã€æ¸¬è©¦ã€éƒ¨ç½²å…¨æµç¨‹å·¥å…·é½Šå…¨

---

## ğŸ“ å‚™è¨»

1. **å„ªå…ˆç´šèªªæ˜**:
   - ğŸ”´ é—œéµ: éƒ¨ç½²é˜»æ–·ï¼Œå¿…é ˆç«‹å³å®Œæˆ
   - ğŸŸ¡ é«˜: é¦–æ¬¡éƒ¨ç½²å¿…éœ€
   - ğŸŸ¢ ä¸­: è‡ªå‹•åŒ–éƒ¨ç½²éœ€è¦
   - ğŸŸ¢ ä½: é–‹ç™¼è¼”åŠ©å·¥å…·
   - âšª å¯é¸: é€²éšåŠŸèƒ½

2. **æ™‚é–“ä¼°ç®—èªªæ˜**:
   - åŸºæ–¼å–®äººé–‹ç™¼
   - åŒ…å«æ¸¬è©¦å’Œæ–‡æª”æ™‚é–“
   - ä¸åŒ…å«ç­‰å¾… Azure Infra Admin çš„æ™‚é–“

3. **ä¾è³´é—œä¿‚**:
   - éšæ®µ 3 å¿…é ˆåœ¨ä»»ä½•éƒ¨ç½²å‰å®Œæˆ
   - éšæ®µ 5 å¿…é ˆåœ¨éšæ®µ 6 å‰å®Œæˆ
   - éšæ®µ 8 (å¯†é‘°) å¿…é ˆåœ¨éšæ®µ 5 å‰å®Œæˆ

4. **å¯ä¸¦è¡ŒåŸ·è¡Œ**:
   - éšæ®µ 4 å¯ä»¥éš¨æ™‚åŸ·è¡Œ
   - éšæ®µ 8 (è¼”åŠ©è…³æœ¬) å¯ä»¥éš¨æ™‚åŸ·è¡Œ
   - éšæ®µ 9 å¯ä»¥åœ¨éšæ®µ 3 å®Œæˆå¾ŒåŸ·è¡Œ
   - éšæ®µ 10 å¯ä»¥ç¨ç«‹åŸ·è¡Œ

---

**æœ€å¾Œæ›´æ–°**: 2025-11-20
**ä¸‹æ¬¡æ›´æ–°**: å®Œæˆæ‰¹æ¬¡ 1 å¾Œ
