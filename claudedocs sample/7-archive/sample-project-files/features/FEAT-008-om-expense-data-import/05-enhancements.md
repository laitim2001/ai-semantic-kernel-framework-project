# FEAT-008: v1.1 æ”¹é€²éœ€æ±‚

> **å»ºç«‹æ—¥æœŸ**: 2025-12-09
> **æœ€å¾Œæ›´æ–°**: 2025-12-09
> **ç‹€æ…‹**: âœ… å·²å®Œæˆ

---

## 1. æ¦‚è¿°

v1.0 ç‰ˆæœ¬å·²å®ŒæˆåŸºæœ¬åŠŸèƒ½ï¼Œä½†ç¶“ç”¨æˆ¶æ¸¬è©¦ç™¼ç¾ä»¥ä¸‹éœ€è¦æ”¹é€²çš„é …ç›®ï¼š

1. **è‹±æ–‡ç¿»è­¯ä¸å®Œæ•´** - é é¢ä¸­æœ‰ 50+ è™•ç¡¬ç·¨ç¢¼ä¸­æ–‡
2. **é è¦½ç¢ºèªæ©Ÿåˆ¶ä¸è¶³** - ç”¨æˆ¶å¸Œæœ›ä¸Šå‚³å¾Œå…ˆé¡¯ç¤ºè©³ç´°é è¦½ï¼Œç¢ºèªå¾Œå†åŸ·è¡Œå°å…¥

---

## 2. Phase 6: è£œå……è‹±æ–‡ç¿»è­¯

### 2.1 éœ€è¦æ–°å¢çš„ç¿»è­¯éµæ¸…å–®

#### 2.1.1 Tabs æ¨™ç±¤
| ç¿»è­¯éµ | English | ç¹é«”ä¸­æ–‡ |
|--------|---------|----------|
| `dataImport.tabs.excel` | Excel File | Excel æª”æ¡ˆ |
| `dataImport.tabs.json` | JSON Data | JSON è³‡æ–™ |

#### 2.1.2 Excel ä¸Šå‚³å€åŸŸ
| ç¿»è­¯éµ | English | ç¹é«”ä¸­æ–‡ |
|--------|---------|----------|
| `dataImport.form.excel.dropzone` | Click or drag Excel file here | é»æ“Šæˆ–æ‹–æ”¾ Excel æª”æ¡ˆåˆ°æ­¤è™• |
| `dataImport.form.excel.supportedFormats` | Supports .xlsx, .xls formats | æ”¯æ´ .xlsx, .xls æ ¼å¼ |
| `dataImport.form.excel.selected` | Selected: {filename} | å·²é¸æ“‡: {filename} |

#### 2.1.3 æŒ‰éˆ•
| ç¿»è­¯éµ | English | ç¹é«”ä¸­æ–‡ |
|--------|---------|----------|
| `dataImport.actions.uploadJson` | Upload JSON | ä¸Šå‚³ JSON |
| `dataImport.actions.clear` | Clear | æ¸…é™¤ |
| `dataImport.actions.confirmImport` | Confirm Import | ç¢ºèªå°å…¥ |
| `dataImport.actions.reupload` | Re-upload | é‡æ–°ä¸Šå‚³ |

#### 2.1.4 éŒ¯èª¤è¨Šæ¯
| ç¿»è­¯éµ | English | ç¹é«”ä¸­æ–‡ |
|--------|---------|----------|
| `dataImport.errors.noWorksheet` | Excel file has no worksheet | Excel æª”æ¡ˆæ²’æœ‰å·¥ä½œè¡¨ |
| `dataImport.errors.cantReadWorksheet` | Cannot read worksheet content | ç„¡æ³•è®€å–å·¥ä½œè¡¨å…§å®¹ |
| `dataImport.errors.noDataRows` | Excel file has no data rows | Excel æª”æ¡ˆæ²’æœ‰è³‡æ–™åˆ— |
| `dataImport.errors.missingHeader` | Row {row}: Missing Header name | ç¬¬ {row} åˆ—: ç¼ºå°‘ Header åç¨± |
| `dataImport.errors.missingCategory` | Row {row}: Missing category | ç¬¬ {row} åˆ—: ç¼ºå°‘é¡åˆ¥ |
| `dataImport.errors.missingItemName` | Row {row}: Missing item name | ç¬¬ {row} åˆ—: ç¼ºå°‘é …ç›®åç¨± |
| `dataImport.errors.missingOpCo` | Row {row}: Missing OpCo name | ç¬¬ {row} åˆ—: ç¼ºå°‘ OpCo åç¨± |
| `dataImport.errors.noValidRows` | No valid data rows | æ²’æœ‰æœ‰æ•ˆçš„è³‡æ–™åˆ— |
| `dataImport.errors.parseError` | Failed to parse Excel file: {error} | è§£æ Excel æª”æ¡ˆå¤±æ•—: {error} |
| `dataImport.errors.readError` | Failed to read file | è®€å–æª”æ¡ˆå¤±æ•— |
| `dataImport.errors.invalidExcelFormat` | Please upload Excel file (.xlsx or .xls) | è«‹ä¸Šå‚³ Excel æª”æ¡ˆ (.xlsx æˆ– .xls) |
| `dataImport.errors.invalidFileFormat` | Please upload Excel (.xlsx) or JSON (.json) file | è«‹ä¸Šå‚³ Excel (.xlsx) æˆ– JSON (.json) æª”æ¡ˆ |

#### 2.1.5 Card æè¿°
| ç¿»è­¯éµ | English | ç¹é«”ä¸­æ–‡ |
|--------|---------|----------|
| `dataImport.form.description` | Supports Excel (.xlsx) or JSON format files | æ”¯æ´ Excel (.xlsx) æˆ– JSON æ ¼å¼æª”æ¡ˆ |
| `dataImport.preview.noData` | Upload file to show preview | ä¸Šå‚³æª”æ¡ˆå¾Œé¡¯ç¤ºé è¦½ |

#### 2.1.6 çµ±è¨ˆé¡¯ç¤º
| ç¿»è­¯éµ | English | ç¹é«”ä¸­æ–‡ |
|--------|---------|----------|
| `dataImport.preview.categories` | Categories | é¡åˆ¥ |
| `dataImport.preview.andMore` | ... and {count} more | ... é‚„æœ‰ {count} å€‹ |

#### 2.1.7 æˆåŠŸè¨Šæ¯
| ç¿»è­¯éµ | English | ç¹é«”ä¸­æ–‡ |
|--------|---------|----------|
| `dataImport.messages.parseSuccess` | Successfully parsed {count} items | æˆåŠŸè§£æ {count} ç­†è³‡æ–™ |
| `dataImport.messages.duplicatesRemoved` | , removed {count} duplicates | ï¼Œç§»é™¤ {count} ç­†é‡è¤‡ |
| `dataImport.messages.errorsFound` | , {count} errors | ï¼Œ{count} ç­†éŒ¯èª¤ |

#### 2.1.8 ç©ºç‹€æ…‹
| ç¿»è­¯éµ | English | ç¹é«”ä¸­æ–‡ |
|--------|---------|----------|
| `dataImport.empty.title` | No data uploaded | å°šæœªä¸Šå‚³è³‡æ–™ |
| `dataImport.empty.description` | Please upload Excel or JSON file on the left | è«‹åœ¨å·¦å´ä¸Šå‚³ Excel æˆ– JSON æª”æ¡ˆ |

#### 2.1.9 Excel æ ¼å¼èªªæ˜è¡¨æ ¼
| ç¿»è­¯éµ | English | ç¹é«”ä¸­æ–‡ |
|--------|---------|----------|
| `dataImport.excelFormat.title` | Excel Column Mapping Guide | Excel æ¬„ä½å°æ‡‰èªªæ˜ |
| `dataImport.excelFormat.description` | Excel file columns must follow this format | Excel æª”æ¡ˆçš„æ¬„ä½é †åºå¿…é ˆç¬¦åˆä»¥ä¸‹æ ¼å¼ |
| `dataImport.excelFormat.columns.field` | Field | æ¬„ä½ |
| `dataImport.excelFormat.columns.excelColumn` | Excel Column | Excel æ¬„ä½ |
| `dataImport.excelFormat.columns.description` | Description | èªªæ˜ |
| `dataImport.excelFormat.columns.required` | Required | å¿…å¡« |
| `dataImport.excelFormat.fields.headerName` | Header Name | Header åç¨± |
| `dataImport.excelFormat.fields.headerDesc` | Header Description | Header æè¿° |
| `dataImport.excelFormat.fields.itemName` | Item Name | é …ç›®åç¨± |
| `dataImport.excelFormat.fields.itemDesc` | Item Description | é …ç›®æè¿° |
| `dataImport.excelFormat.fields.category` | Category | é¡åˆ¥ |
| `dataImport.excelFormat.fields.budgetAmount` | Budget Amount | é ç®—é‡‘é¡ |
| `dataImport.excelFormat.fields.opCoName` | OpCo Name | OpCo åç¨± |
| `dataImport.excelFormat.fields.endDate` | End Date | çµæŸæ—¥æœŸ |
| `dataImport.excelFormat.fields.lastFYActual` | Last FY Actual Expense | å»å¹´å¯¦éš›è²»ç”¨ |
| `dataImport.excelFormat.desc.headerName` | OM expense header name | OM è²»ç”¨è¡¨é ­åç¨± |
| `dataImport.excelFormat.desc.headerDesc` | Header description | è¡¨é ­æè¿°èªªæ˜ |
| `dataImport.excelFormat.desc.itemName` | Detail item name | æ˜ç´°é …ç›®åç¨± |
| `dataImport.excelFormat.desc.itemDesc` | Item description | é …ç›®æè¿°èªªæ˜ |
| `dataImport.excelFormat.desc.category` | Expense category | è²»ç”¨é¡åˆ¥ |
| `dataImport.excelFormat.desc.budgetAmount` | Budget amount (USD) | é ç®—é‡‘é¡ (USD) |
| `dataImport.excelFormat.desc.opCoName` | Operating company name | ç‡Ÿé‹å…¬å¸åç¨± |
| `dataImport.excelFormat.desc.endDate` | Maintenance end date | ç¶­è­·åˆ°æœŸæ—¥ |
| `dataImport.excelFormat.desc.lastFYActual` | Last fiscal year actual expense | ä¸Šä¸€è²¡å¹´å¯¦éš›è²»ç”¨ |
| `dataImport.excelFormat.required.yes` | Yes | æ˜¯ |
| `dataImport.excelFormat.required.no` | No | å¦ |
| `dataImport.excelFormat.required.default0` | No (default 0) | å¦ (é è¨­ 0) |

#### 2.1.10 æ³¨æ„äº‹é …
| ç¿»è­¯éµ | English | ç¹é«”ä¸­æ–‡ |
|--------|---------|----------|
| `dataImport.excelFormat.notes.title` | Notes: | æ³¨æ„äº‹é …ï¼š |
| `dataImport.excelFormat.notes.skipHeader` | First row is header row, will be skipped | ç¬¬ä¸€åˆ—ç‚ºæ¨™é¡Œåˆ—ï¼Œæœƒè‡ªå‹•è·³é |
| `dataImport.excelFormat.notes.removeDuplicates` | Duplicate items (same Header + Item + OpCo) will be removed | é‡è¤‡é …ç›®ï¼ˆHeader + Item + OpCo ç›¸åŒï¼‰æœƒè‡ªå‹•ç§»é™¤ |
| `dataImport.excelFormat.notes.skipEmpty` | Empty rows will be ignored | ç©ºç™½åˆ—æœƒè‡ªå‹•å¿½ç•¥ |
| `dataImport.excelFormat.notes.autoCreateOpCo` | OpCo will be created if not exists | OpCo ä¸å­˜åœ¨æ™‚æœƒè‡ªå‹•å»ºç«‹ |
| `dataImport.excelFormat.notes.autoCreateHeader` | Header will be created if not exists (category required) | Header ä¸å­˜åœ¨æ™‚æœƒè‡ªå‹•å»ºç«‹ï¼ˆéœ€è¦æŒ‡å®šé¡åˆ¥ï¼‰ |

**ç¸½è¨ˆï¼šç´„ 60 å€‹ç¿»è­¯éµ**

---

## 3. Phase 7: é è¦½ç¢ºèªæ©Ÿåˆ¶

### 3.1 ç›®æ¨™

è®“ç”¨æˆ¶åœ¨åŸ·è¡Œå°å…¥å‰ï¼Œèƒ½å¤ æ¸…æ¥šçœ‹åˆ°ï¼š
1. **è§£æçµ±è¨ˆæ‘˜è¦** - ç¸½è³‡æ–™ã€Headersã€Itemsã€OpCos ç­‰
2. **OM Expense Headers åˆ—è¡¨** - å°‡è¦å»ºç«‹/æ›´æ–°çš„è¡¨é ­
3. **OM Expense Items æ˜ç´°** - å‰ N ç­†è³‡æ–™çš„è©³ç´°é è¦½
4. **æœ‰å•é¡Œçš„æ•¸æ“šè¡Œ** - å“ªäº›è¡Œæœ‰å•é¡Œï¼Œä»€éº¼åŸå› 
5. **é‡è¤‡æ•¸æ“šè¡Œ** - å“ªäº›è¡Œè¢«è­˜åˆ¥ç‚ºé‡è¤‡

### 3.2 UI è¨­è¨ˆ

#### 3.2.1 æ•´é«”æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: ä¸Šå‚³æª”æ¡ˆ  â†’  Step 2: é è¦½ç¢ºèª  â†’  Step 3: å°å…¥çµæœ    â”‚
â”‚      [â—]                  [â—‹]                  [â—‹]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2.2 Step 2: é è¦½ç¢ºèªé é¢çµæ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ğŸ“‹ è§£æçµæœé è¦½                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“Š çµ±è¨ˆæ‘˜è¦      â”‚  â”‚ âš ï¸ å•é¡Œæ•¸æ“š      â”‚  â”‚ ğŸ”„ é‡è¤‡æ•¸æ“š      â”‚  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚
â”‚  â”‚ ç¸½è³‡æ–™: 500     â”‚  â”‚ å•é¡Œè¡Œ: 8       â”‚  â”‚ é‡è¤‡è¡Œ: 5       â”‚  â”‚
â”‚  â”‚ æœ‰æ•ˆè³‡æ–™: 352   â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚
â”‚  â”‚ Headers: 69     â”‚  â”‚ [å±•é–‹æŸ¥çœ‹]      â”‚  â”‚ [å±•é–‹æŸ¥çœ‹]      â”‚  â”‚
â”‚  â”‚ OpCos: 42       â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ğŸ“‘ OM Expense Headers (69 å€‹)                              â”‚â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚ â”‚ Header Name      â”‚ Category    â”‚ Items â”‚ Status      â”‚   â”‚â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚â”‚
â”‚  â”‚ â”‚ Anaplan          â”‚ Software    â”‚ 5     â”‚ ğŸ†• æ–°å»º      â”‚   â”‚â”‚
â”‚  â”‚ â”‚ ServiceNow       â”‚ Application â”‚ 3     â”‚ ğŸ†• æ–°å»º      â”‚   â”‚â”‚
â”‚  â”‚ â”‚ Azure            â”‚ Cloud       â”‚ 8     â”‚ âœ… å·²å­˜åœ¨    â”‚   â”‚â”‚
â”‚  â”‚ â”‚ ...              â”‚ ...         â”‚ ...   â”‚ ...         â”‚   â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â”‚ [é¡¯ç¤ºå…¨éƒ¨ 69 å€‹] [æ”¶åˆ]                                     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ğŸ“‹ OM Expense Items æ˜ç´° (å‰ 10 ç­†)                        â”‚â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚ â”‚ # â”‚ Header    â”‚ Item Name     â”‚ OpCo  â”‚ Budget  â”‚ Statusâ”‚â”‚â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚â”‚
â”‚  â”‚ â”‚ 1 â”‚ Anaplan   â”‚ Model Builder â”‚ RHK   â”‚ $5,000  â”‚ âœ…    â”‚â”‚â”‚
â”‚  â”‚ â”‚ 2 â”‚ Anaplan   â”‚ License       â”‚ RIT   â”‚ $3,000  â”‚ âœ…    â”‚â”‚â”‚
â”‚  â”‚ â”‚ 3 â”‚ ServiceNowâ”‚ ITSM Module   â”‚ RHK   â”‚ $8,000  â”‚ âœ…    â”‚â”‚â”‚
â”‚  â”‚ â”‚ 4 â”‚ (å•é¡Œè¡Œ)  â”‚ -             â”‚ -     â”‚ -       â”‚ âš ï¸    â”‚â”‚â”‚
â”‚  â”‚ â”‚...â”‚ ...       â”‚ ...           â”‚ ...   â”‚ ...     â”‚ ...   â”‚â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â”‚ é¡¯ç¤º 10 / 352 ç­†è³‡æ–™  [è¼‰å…¥æ›´å¤š]                            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ âš ï¸ æœ‰å•é¡Œçš„æ•¸æ“šè¡Œ (8 ç­†)                     [å±•é–‹/æ”¶åˆ]    â”‚â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚â”‚
â”‚  â”‚ â”‚ è¡Œè™Ÿ â”‚ å•é¡Œæ¬„ä½      â”‚ åŸå›                 â”‚ åŸå§‹è³‡æ–™    â”‚ â”‚â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚â”‚
â”‚  â”‚ â”‚ 15   â”‚ Header Name   â”‚ ç¼ºå°‘å¿…å¡«æ¬„ä½        â”‚ (ç©º)        â”‚ â”‚â”‚
â”‚  â”‚ â”‚ 28   â”‚ Category      â”‚ ç„¡æ•ˆçš„é¡åˆ¥åç¨±      â”‚ "Unknown"   â”‚ â”‚â”‚
â”‚  â”‚ â”‚ 45   â”‚ OpCo Name     â”‚ ç¼ºå°‘å¿…å¡«æ¬„ä½        â”‚ (ç©º)        â”‚ â”‚â”‚
â”‚  â”‚ â”‚ ...  â”‚ ...           â”‚ ...                â”‚ ...         â”‚ â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ğŸ”„ é‡è¤‡æ•¸æ“šè¡Œ (5 ç­†)                         [å±•é–‹/æ”¶åˆ]    â”‚â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚â”‚
â”‚  â”‚ â”‚ è¡Œè™Ÿ   â”‚ Header       â”‚ Item Name    â”‚ OpCo   â”‚ é‡è¤‡è¡Œè™Ÿ â”‚ â”‚â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚â”‚
â”‚  â”‚ â”‚ 125    â”‚ Anaplan      â”‚ License      â”‚ RHK    â”‚ 12       â”‚ â”‚â”‚
â”‚  â”‚ â”‚ 230    â”‚ ServiceNow   â”‚ ITSM Module  â”‚ RIT    â”‚ 55, 180  â”‚ â”‚â”‚
â”‚  â”‚ â”‚ ...    â”‚ ...          â”‚ ...          â”‚ ...    â”‚ ...      â”‚ â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚         [é‡æ–°ä¸Šå‚³]        [ç¢ºèªå°å…¥ 352 ç­†è³‡æ–™]             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 è³‡æ–™çµæ§‹è¨­è¨ˆ

#### 3.3.1 è§£æçµæœè³‡æ–™çµæ§‹

```typescript
interface ParseResult {
  // çµ±è¨ˆæ‘˜è¦
  statistics: {
    totalRows: number;           // åŸå§‹è³‡æ–™ç¸½è¡Œæ•¸
    validItems: number;          // æœ‰æ•ˆè³‡æ–™ç­†æ•¸
    skippedRows: number;         // è·³éçš„è¡Œæ•¸ (ç©ºè¡Œç­‰)
    errorRows: number;           // æœ‰å•é¡Œçš„è¡Œæ•¸
    duplicateRows: number;       // é‡è¤‡çš„è¡Œæ•¸
    uniqueHeaders: number;       // å”¯ä¸€ Headers æ•¸é‡
    uniqueOpCos: number;         // å”¯ä¸€ OpCos æ•¸é‡
    uniqueCategories: number;    // å”¯ä¸€ Categories æ•¸é‡
  };

  // Headers é è¦½
  headers: {
    name: string;
    category: string;
    description: string | null;
    itemCount: number;           // è©² Header ä¸‹çš„ Item æ•¸é‡
    status: 'new' | 'existing';  // æ–°å»º or å·²å­˜åœ¨
  }[];

  // Items é è¦½ (å‰ N ç­†)
  items: {
    rowNumber: number;           // åŸå§‹ Excel è¡Œè™Ÿ
    headerName: string;
    itemName: string;
    opCoName: string;
    budgetAmount: number;
    endDate: string | null;
    lastFYActualExpense: number | null;
    status: 'valid' | 'error' | 'duplicate';
  }[];

  // æœ‰å•é¡Œçš„æ•¸æ“šè¡Œ
  errorRows: {
    rowNumber: number;           // åŸå§‹ Excel è¡Œè™Ÿ
    field: string;               // å•é¡Œæ¬„ä½
    reason: string;              // å•é¡ŒåŸå› 
    rawValue: string | null;     // åŸå§‹å€¼
  }[];

  // é‡è¤‡æ•¸æ“šè¡Œ
  duplicateRows: {
    rowNumber: number;           // ç•¶å‰è¡Œè™Ÿ
    headerName: string;
    itemName: string;
    opCoName: string;
    duplicateOf: number[];       // é‡è¤‡çš„è¡Œè™Ÿåˆ—è¡¨
  }[];

  // å°å…¥ç”¨çš„æœ‰æ•ˆè³‡æ–™
  validData: ImportItem[];
}
```

#### 3.3.2 ç‹€æ…‹æ©Ÿ

```typescript
type ImportPageState =
  | { step: 'upload' }                                          // Step 1: ä¸Šå‚³
  | { step: 'preview'; parseResult: ParseResult }              // Step 2: é è¦½
  | { step: 'importing'; itemCount: number }                   // å°å…¥ä¸­
  | { step: 'success'; result: ImportResult }                  // Step 3: æˆåŠŸ
  | { step: 'error'; error: string; duplicateInfo?: object };  // Step 3: å¤±æ•—
```

### 3.4 å¯¦ä½œè¨ˆåŠƒ

#### 3.4.1 å‰ç«¯è®Šæ›´

| è®Šæ›´ | èªªæ˜ |
|------|------|
| æ›´æ–° `page.tsx` | æ”¹ç‚ºä¸‰æ­¥é©Ÿæµç¨‹ |
| æ–°å¢ `ImportPreview.tsx` | é è¦½ç¢ºèªçµ„ä»¶ |
| æ–°å¢ `HeadersTable.tsx` | Headers é è¦½è¡¨æ ¼ |
| æ–°å¢ `ItemsTable.tsx` | Items é è¦½è¡¨æ ¼ |
| æ–°å¢ `ErrorRowsTable.tsx` | å•é¡Œæ•¸æ“šè¡¨æ ¼ |
| æ–°å¢ `DuplicateRowsTable.tsx` | é‡è¤‡æ•¸æ“šè¡¨æ ¼ |
| æ›´æ–° Excel è§£æé‚è¼¯ | æ”¶é›†æ›´è©³ç´°çš„éŒ¯èª¤å’Œé‡è¤‡è³‡è¨Š |

#### 3.4.2 ä¸éœ€è¦å¾Œç«¯è®Šæ›´

é è¦½ç¢ºèªæ©Ÿåˆ¶å®Œå…¨åœ¨å‰ç«¯å¯¦ä½œï¼š
- Excel è§£æåœ¨å®¢æˆ¶ç«¯é€²è¡Œ
- é è¦½æ•¸æ“šçµæ§‹ç”±å‰ç«¯ç”Ÿæˆ
- åªæœ‰åœ¨ç”¨æˆ¶ç¢ºèªå¾Œæ‰å‘¼å«å¾Œç«¯ API

### 3.5 å„ªå…ˆç´š

| åŠŸèƒ½ | å„ªå…ˆç´š | èªªæ˜ |
|------|--------|------|
| çµ±è¨ˆæ‘˜è¦ | é«˜ | å¿…é ˆé¡¯ç¤ºåŸºæœ¬çµ±è¨ˆ |
| æœ‰å•é¡Œçš„æ•¸æ“šè¡Œ | é«˜ | ç”¨æˆ¶æœ€é—œå¿ƒçš„è³‡è¨Š |
| é‡è¤‡æ•¸æ“šè¡Œ | é«˜ | é¿å…é‡è¤‡å°å…¥ |
| Headers é è¦½è¡¨æ ¼ | ä¸­ | å¹«åŠ©ç¢ºèª Header çµæ§‹ |
| Items è©³ç´°é è¦½ | ä¸­ | å¯ä»¥åªé¡¯ç¤ºå‰ 10 ç­† |
| æ­¥é©Ÿé€²åº¦æŒ‡ç¤ºå™¨ | ä½ | UI ç¾åŒ– |

---

## 4. å¯¦æ–½è¨ˆåŠƒ

### Phase 6: è£œå……è‹±æ–‡ç¿»è­¯ (é ä¼° 1 å°æ™‚) âœ… å·²å®Œæˆ

- [x] æ›´æ–° `en.json` æ–°å¢ 60 å€‹ç¿»è­¯éµ
- [x] æ›´æ–° `zh-TW.json` æ–°å¢å°æ‡‰ç¿»è­¯
- [x] æ›´æ–° `page.tsx` æ›¿æ›æ‰€æœ‰ç¡¬ç·¨ç¢¼ä¸­æ–‡
- [x] åŸ·è¡Œ `pnpm validate:i18n` é©—è­‰
- [x] æ¸¬è©¦ `/en/data-import` é é¢

### Phase 7: é è¦½ç¢ºèªæ©Ÿåˆ¶ (é ä¼° 3-4 å°æ™‚) âœ… å·²å®Œæˆ

- [x] æ›´æ–° Excel è§£æé‚è¼¯ï¼Œæ”¶é›†è©³ç´°éŒ¯èª¤è³‡è¨Š
- [x] å»ºç«‹ `ParseResult` è³‡æ–™çµæ§‹
- [x] æ•´åˆé è¦½çµ„ä»¶åˆ° `page.tsx` (å…§è¯å¯¦ä½œ)
- [x] æ–°å¢éŒ¯èª¤è¡Œè¡¨æ ¼ (ErrorRows Table)
- [x] æ–°å¢é‡è¤‡è¡Œè¡¨æ ¼ (DuplicateRows Table)
- [x] æ›´æ–° `page.tsx` æ”¹ç‚ºä¸‰æ­¥é©Ÿæµç¨‹ (upload â†’ preview â†’ result)
- [x] æ–°å¢é è¦½ç›¸é—œç¿»è­¯éµ (statistics, headersPreview, itemsPreview, actions)
- [x] æ¸¬è©¦å®Œæ•´æµç¨‹

---

## 5. é©—æ”¶æ¨™æº–

### Phase 6 é©—æ”¶ âœ…

- [x] `/en/data-import` é é¢ç„¡ä»»ä½•ä¸­æ–‡é¡¯ç¤º
- [x] `/zh-TW/data-import` é é¢é¡¯ç¤ºæ­£ç¢ºä¸­æ–‡
- [x] `pnpm validate:i18n` é€šé (2249 å€‹éµçµæ§‹ä¸€è‡´)

### Phase 7 é©—æ”¶ âœ…

- [x] ä¸Šå‚³ Excel å¾Œé¡¯ç¤ºè©³ç´°é è¦½
- [x] çµ±è¨ˆæ‘˜è¦é¡¯ç¤ºæ­£ç¢ºæ•¸æ“š (8 å€‹çµ±è¨ˆæŒ‡æ¨™)
- [x] æœ‰å•é¡Œçš„æ•¸æ“šè¡Œæ¸…æ¥šé¡¯ç¤ºï¼ˆè¡Œè™Ÿã€å•é¡Œæ¬„ä½ã€åŸå› ã€åŸå§‹å€¼ï¼‰
- [x] é‡è¤‡æ•¸æ“šè¡Œæ¸…æ¥šé¡¯ç¤ºï¼ˆè¡Œè™Ÿã€é‡è¤‡çš„çµ„åˆï¼‰
- [x] Headers åˆ—è¡¨é¡¯ç¤ºï¼ˆåç¨±ã€é¡åˆ¥ã€æè¿°ã€Item æ•¸é‡ï¼‰
- [x] Items é è¦½é¡¯ç¤ºï¼ˆé è¨­ 10 ç­†ï¼Œå¯è¼‰å…¥æ›´å¤šï¼‰
- [x] ã€Œç¢ºèªå°å…¥ã€æŒ‰éˆ•æ­£å¸¸é‹ä½œ
- [x] ã€Œé‡æ–°ä¸Šå‚³ã€æŒ‰éˆ•æ­£å¸¸é‹ä½œ

---

## 6. ç›¸é—œæ–‡æª”

- [01-requirements.md](./01-requirements.md) - åŸå§‹éœ€æ±‚
- [02-technical-design.md](./02-technical-design.md) - æŠ€è¡“è¨­è¨ˆ
- [03-implementation-plan.md](./03-implementation-plan.md) - å¯¦æ–½è¨ˆåŠƒ
- [04-progress.md](./04-progress.md) - é€²åº¦è¿½è¹¤
