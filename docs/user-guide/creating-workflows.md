# å·¥ä½œæµå‰µå»ºæ•™ç¨‹

æœ¬æ•™ç¨‹å°‡è©³ç´°ä»‹ç´¹å¦‚ä½•å‰µå»ºå’Œé…ç½® IPA Platform å·¥ä½œæµã€‚

---

## ç›®éŒ„

1. [å·¥ä½œæµåŸºç¤](#å·¥ä½œæµåŸºç¤)
2. [ç¯€é»é¡å‹](#ç¯€é»é¡å‹)
3. [è§¸ç™¼æ–¹å¼](#è§¸ç™¼æ–¹å¼)
4. [æ¢ä»¶åˆ†æ”¯](#æ¢ä»¶åˆ†æ”¯)
5. [è®Šæ•¸èˆ‡åƒæ•¸](#è®Šæ•¸èˆ‡åƒæ•¸)
6. [éŒ¯èª¤è™•ç†](#éŒ¯èª¤è™•ç†)
7. [æœ€ä½³å¯¦è¸](#æœ€ä½³å¯¦è¸)

---

## å·¥ä½œæµåŸºç¤

### ä»€éº¼æ˜¯å·¥ä½œæµï¼Ÿ

å·¥ä½œæµæ˜¯ä¸€ç³»åˆ—æŒ‰ç‰¹å®šé †åºåŸ·è¡Œçš„è‡ªå‹•åŒ–æ­¥é©Ÿï¼Œç”¨æ–¼å®Œæˆæ¥­å‹™æµç¨‹ã€‚

### å·¥ä½œæµçµ„æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å·¥ä½œæµ (Workflow)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚   [é–‹å§‹] â”€â†’ [ç¯€é»1] â”€â†’ [ç¯€é»2] â”€â†’ [æ¢ä»¶] â”€â†’ [çµæŸ]     â”‚
â”‚                                      â”‚                  â”‚
â”‚                                      â””â”€â†’ [ç¯€é»3] â”€â†’ â”€â”˜ â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å‰µå»ºæ–°å·¥ä½œæµ

1. å°èˆªåˆ° **å·¥ä½œæµ** é é¢
2. é»æ“Š **+ æ–°å¢å·¥ä½œæµ**
3. å¡«å¯«åŸºæœ¬è³‡è¨Šï¼š

```yaml
åç¨±: IT ç¥¨æ“šè‡ªå‹•è™•ç†
æè¿°: è‡ªå‹•åˆ†é¡å’Œåˆ†é… IT æ”¯æ´ç¥¨æ“š
æ¨™ç±¤: [IT, è‡ªå‹•åŒ–, ç¥¨æ“š]
è§¸ç™¼æ–¹å¼: Webhook
```

---

## ç¯€é»é¡å‹

IPA Platform æä¾›å¤šç¨®ç¯€é»é¡å‹ï¼š

### 1. æ§åˆ¶ç¯€é»

| ç¯€é» | åœ–ç¤º | ç”¨é€” |
|------|------|------|
| **é–‹å§‹ç¯€é»** | âšª | å·¥ä½œæµå…¥å£é» |
| **çµæŸç¯€é»** | â¬› | å·¥ä½œæµçµæŸé» |
| **æ¢ä»¶ç¯€é»** | ğŸ”€ | æ¢ä»¶åˆ†æ”¯åˆ¤æ–· |
| **ä¸¦è¡Œç¯€é»** | âš¡ | ä¸¦è¡ŒåŸ·è¡Œå¤šå€‹åˆ†æ”¯ |
| **åˆä½µç¯€é»** | ğŸ”— | åˆä½µä¸¦è¡Œåˆ†æ”¯ |

### 2. å‹•ä½œç¯€é»

| ç¯€é» | ç”¨é€” | ç¯„ä¾‹ |
|------|------|------|
| **HTTP è«‹æ±‚** | å‘¼å«å¤–éƒ¨ API | å‘¼å« ServiceNow API |
| **æ•¸æ“šè½‰æ›** | è™•ç†å’Œè½‰æ›æ•¸æ“š | JSON è½‰æ›ã€æ¬„ä½æ˜ å°„ |
| **æ—¥èªŒè¨˜éŒ„** | è¨˜éŒ„åŸ·è¡Œè³‡è¨Š | åµéŒ¯è¨Šæ¯ã€å¯©è¨ˆæ—¥èªŒ |
| **å»¶é²ç­‰å¾…** | æš«åœåŸ·è¡Œ | ç­‰å¾… 5 åˆ†é˜å¾Œç¹¼çºŒ |
| **è®Šæ•¸è¨­å®š** | è¨­å®š/æ›´æ–°è®Šæ•¸ | ä¿å­˜ä¸­é–“çµæœ |

### 3. AI Agent ç¯€é»

| ç¯€é» | ç”¨é€” | ç¯„ä¾‹ |
|------|------|------|
| **LLM å‘¼å«** | å‘¼å«å¤§å‹èªè¨€æ¨¡å‹ | GPT-4 æ–‡æœ¬åˆ†æ |
| **Agent åŸ·è¡Œ** | åŸ·è¡Œé é…ç½® Agent | å®¢æœ Agentã€åˆ†æ Agent |
| **æç¤ºæ¨¡æ¿** | ä½¿ç”¨æç¤ºæ¨¡æ¿ | ç¥¨æ“šåˆ†é¡æç¤º |

### 4. æ•´åˆç¯€é»

| ç¯€é» | æ•´åˆæœå‹™ | ç”¨é€” |
|------|----------|------|
| **ServiceNow** | ServiceNow | ç¥¨æ“šç®¡ç† |
| **Dynamics 365** | Microsoft CRM | å®¢æˆ¶é—œä¿‚ç®¡ç† |
| **Teams** | Microsoft Teams | é€šçŸ¥ã€å¯©æ‰¹ |
| **n8n** | n8n Workflow | å¤–éƒ¨å·¥ä½œæµè§¸ç™¼ |

### 5. æª¢æŸ¥é»ç¯€é»

| ç¯€é» | ç”¨é€” |
|------|------|
| **äººå·¥å¯©æ‰¹** | éœ€è¦äººå·¥ç¢ºèªæ‰èƒ½ç¹¼çºŒ |
| **æ¢ä»¶å¯©æ‰¹** | æ ¹æ“šæ¢ä»¶æ±ºå®šæ˜¯å¦éœ€è¦å¯©æ‰¹ |

---

## è§¸ç™¼æ–¹å¼

### æ‰‹å‹•è§¸ç™¼

æœ€ç°¡å–®çš„è§¸ç™¼æ–¹å¼ï¼Œé©åˆæ¸¬è©¦å’Œè‡¨æ™‚åŸ·è¡Œã€‚

```yaml
trigger:
  type: manual
```

### æ’ç¨‹è§¸ç™¼

ä½¿ç”¨ Cron è¡¨é”å¼å®šæ™‚åŸ·è¡Œï¼š

```yaml
trigger:
  type: scheduled
  cron: "0 9 * * 1-5"  # æ¯é€±ä¸€è‡³é€±äº”æ—©ä¸Š 9:00
  timezone: "Asia/Taipei"
```

**å¸¸ç”¨ Cron è¡¨é”å¼**:

| è¡¨é”å¼ | èªªæ˜ |
|--------|------|
| `0 * * * *` | æ¯å°æ™‚æ•´é» |
| `0 9 * * *` | æ¯å¤©æ—©ä¸Š 9:00 |
| `0 9 * * 1` | æ¯é€±ä¸€æ—©ä¸Š 9:00 |
| `0 0 1 * *` | æ¯æœˆ 1 è™Ÿåˆå¤œ |

### Webhook è§¸ç™¼

é€é HTTP è«‹æ±‚è§¸ç™¼ï¼š

```yaml
trigger:
  type: webhook
  path: /webhooks/it-ticket
  method: POST
  authentication: jwt
```

**è§¸ç™¼ç¯„ä¾‹**:
```bash
curl -X POST https://api.ipa-platform.com/webhooks/it-ticket \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"ticket_id": "INC001234", "priority": "high"}'
```

### äº‹ä»¶è§¸ç™¼

ç›£è½ç³»çµ±äº‹ä»¶ï¼š

```yaml
trigger:
  type: event
  source: servicenow
  event_type: ticket.created
  filters:
    category: IT
    priority: [high, critical]
```

---

## æ¢ä»¶åˆ†æ”¯

### ç°¡å–®æ¢ä»¶

```yaml
condition:
  name: æª¢æŸ¥å„ªå…ˆç´š
  expression: "{{ input.priority == 'high' }}"
  branches:
    - name: é«˜å„ªå…ˆç´š
      next: urgent_handler
    - name: ä¸€èˆ¬å„ªå…ˆç´š
      next: normal_handler
```

### å¤šæ¢ä»¶åˆ¤æ–·

```yaml
condition:
  name: ç¥¨æ“šåˆ†é¡
  type: switch
  expression: "{{ input.category }}"
  cases:
    - value: "hardware"
      next: hardware_team
    - value: "software"
      next: software_team
    - value: "network"
      next: network_team
  default: general_support
```

### è¤‡åˆæ¢ä»¶

```yaml
condition:
  name: VIP å®¢æˆ¶é«˜å„ªå…ˆç´š
  expression: |
    {{ input.priority == 'high' and input.customer_tier == 'VIP' }}
  branches:
    - name: ç¬¦åˆ
      next: vip_express_lane
    - name: ä¸ç¬¦åˆ
      next: standard_queue
```

---

## è®Šæ•¸èˆ‡åƒæ•¸

### è¼¸å…¥åƒæ•¸

å®šç¾©å·¥ä½œæµæ¥å—çš„åƒæ•¸ï¼š

```yaml
inputs:
  - name: ticket_id
    type: string
    required: true
    description: ç¥¨æ“š ID
  - name: priority
    type: enum
    values: [low, medium, high, critical]
    default: medium
  - name: metadata
    type: object
    required: false
```

### å·¥ä½œæµè®Šæ•¸

åœ¨ç¯€é»é–“å‚³éæ•¸æ“šï¼š

```yaml
# è¨­å®šè®Šæ•¸
set_variable:
  name: analysis_result
  value: "{{ nodes.llm_analysis.output.classification }}"

# ä½¿ç”¨è®Šæ•¸
http_request:
  url: "https://api.servicenow.com/tickets"
  body:
    classification: "{{ variables.analysis_result }}"
```

### å…§å»ºè®Šæ•¸

| è®Šæ•¸ | èªªæ˜ |
|------|------|
| `{{ workflow.id }}` | å·¥ä½œæµ ID |
| `{{ workflow.name }}` | å·¥ä½œæµåç¨± |
| `{{ execution.id }}` | ç•¶å‰åŸ·è¡Œ ID |
| `{{ execution.started_at }}` | åŸ·è¡Œé–‹å§‹æ™‚é–“ |
| `{{ input.* }}` | è¼¸å…¥åƒæ•¸ |
| `{{ nodes.*.output }}` | ç¯€é»è¼¸å‡º |
| `{{ variables.* }}` | å·¥ä½œæµè®Šæ•¸ |

---

## éŒ¯èª¤è™•ç†

### é‡è©¦ç­–ç•¥

```yaml
node:
  name: å‘¼å«å¤–éƒ¨ API
  type: http_request
  retry:
    max_attempts: 3
    delay_seconds: 5
    backoff_multiplier: 2  # æŒ‡æ•¸é€€é¿
    retryable_errors:
      - timeout
      - 5xx
```

### éŒ¯èª¤è™•ç†ç¯€é»

```yaml
node:
  name: è™•ç†å¤±æ•—
  type: error_handler
  on_error:
    - log_error
    - notify_admin
    - set_status_failed
```

### å…¨åŸŸéŒ¯èª¤è™•ç†

```yaml
workflow:
  error_handling:
    on_failure:
      - notify_team
      - create_incident
    on_timeout:
      - send_alert
      - cancel_execution
```

---

## æœ€ä½³å¯¦è¸

### 1. å‘½åè¦ç¯„

```yaml
# âœ… å¥½çš„å‘½å
workflow_name: IT-Ticket-Auto-Classification
node_name: validate-input-parameters

# âŒ ä¸å¥½çš„å‘½å
workflow_name: workflow1
node_name: node_a
```

### 2. æ¨¡çµ„åŒ–è¨­è¨ˆ

å°‡è¤‡é›œå·¥ä½œæµæ‹†åˆ†ç‚ºå­å·¥ä½œæµï¼š

```
ä¸»å·¥ä½œæµ
â”œâ”€â”€ å­å·¥ä½œæµ: æ•¸æ“šé©—è­‰
â”œâ”€â”€ å­å·¥ä½œæµ: AI åˆ†æ
â””â”€â”€ å­å·¥ä½œæµ: çµæœè™•ç†
```

### 3. éŒ¯èª¤è™•ç†

- æ¯å€‹å¤–éƒ¨å‘¼å«éƒ½æ‡‰æœ‰é‡è©¦ç­–ç•¥
- è¨­ç½®åˆç†çš„è¶…æ™‚æ™‚é–“
- è¨˜éŒ„è¶³å¤ çš„éŒ¯èª¤è³‡è¨Š

### 4. æ•ˆèƒ½å„ªåŒ–

- ä½¿ç”¨ä¸¦è¡Œç¯€é»è™•ç†ç¨ç«‹ä»»å‹™
- é¿å…ä¸å¿…è¦çš„ API å‘¼å«
- åˆç†è¨­ç½®ç·©å­˜

### 5. å®‰å…¨è€ƒæ…®

- ä¸è¦åœ¨å·¥ä½œæµä¸­ç¡¬ç·¨ç¢¼æ•æ„Ÿè³‡è¨Š
- ä½¿ç”¨å®‰å…¨çš„è®Šæ•¸å­˜å„²
- é™åˆ¶ Webhook çš„è¨ªå•æ¬Šé™

---

## ç¯„ä¾‹å·¥ä½œæµ

### IT ç¥¨æ“šè‡ªå‹•åˆ†é¡

```yaml
name: IT-Ticket-Auto-Classification
description: ä½¿ç”¨ AI è‡ªå‹•åˆ†é¡ IT æ”¯æ´ç¥¨æ“š

trigger:
  type: webhook
  path: /webhooks/it-ticket

inputs:
  - name: ticket_id
    type: string
    required: true
  - name: title
    type: string
    required: true
  - name: description
    type: string
    required: true

nodes:
  - id: start
    type: start

  - id: validate_input
    type: data_transform
    config:
      validate:
        - field: title
          min_length: 5
        - field: description
          min_length: 10

  - id: ai_classification
    type: agent
    config:
      agent_id: ticket-classifier
      input:
        title: "{{ input.title }}"
        description: "{{ input.description }}"

  - id: update_ticket
    type: http_request
    config:
      url: "{{ secrets.servicenow_url }}/api/tickets/{{ input.ticket_id }}"
      method: PATCH
      body:
        category: "{{ nodes.ai_classification.output.category }}"
        priority: "{{ nodes.ai_classification.output.priority }}"
        assigned_team: "{{ nodes.ai_classification.output.team }}"

  - id: notify_team
    type: teams_notification
    config:
      channel: "{{ nodes.ai_classification.output.team }}-tickets"
      message: |
        æ–°ç¥¨æ“šå·²åˆ†é…:
        - ID: {{ input.ticket_id }}
        - é¡åˆ¥: {{ nodes.ai_classification.output.category }}
        - å„ªå…ˆç´š: {{ nodes.ai_classification.output.priority }}

  - id: end
    type: end

edges:
  - from: start
    to: validate_input
  - from: validate_input
    to: ai_classification
  - from: ai_classification
    to: update_ticket
  - from: update_ticket
    to: notify_team
  - from: notify_team
    to: end
```

---

## ä¸‹ä¸€æ­¥

- [åŸ·è¡Œå·¥ä½œæµ](executing-workflows.md) - äº†è§£åŸ·è¡Œå’Œç›£æ§
- [ç›£æ§èˆ‡å‘Šè­¦](monitoring.md) - è¨­ç½®ç›£æ§å’Œé€šçŸ¥
- [API æ–‡æª”](/api/openapi.yaml) - API åƒè€ƒ

---

*æœ€å¾Œæ›´æ–°: 2025-11-26*
