# Sprint 103 決策記錄

## 概述

記錄 Sprint 103 開發過程中的重要技術決策和設計選擇。

---

## 決策 1: Drawer vs Dialog

**日期**: 2026-01-29
**狀態**: 已決定

### 背景
需要決定 Worker 詳情的呈現方式。

### 選項
1. **Dialog (Modal)**: 居中彈出，阻斷背景
2. **Sheet/Drawer**: 從側邊滑出，不阻斷背景

### 決定
選擇 **Sheet/Drawer (從右側滑出)**

### 理由
- 保持主面板可見，便於對比多個 Worker
- 更符合"詳情面板"的使用場景
- 滑動動畫更流暢
- 空間更充足，適合展示複雜內容

---

## 決策 2: 數據獲取策略

**日期**: 2026-01-29
**狀態**: 已決定

### 背景
需要決定如何獲取 Worker 詳情數據。

### 選項
1. **一次性加載**: 打開 Drawer 時加載全部數據
2. **按需加載**: 分塊加載不同部分
3. **輪詢更新**: 定期更新運行中的 Worker

### 決定
採用 **混合策略**:
- 初始一次性加載全部數據
- 對於 `status === 'running'` 的 Worker，啟用 2 秒輪詢
- 對於已完成的 Worker，不輪詢

### 理由
- 減少初始請求數
- 確保運行中的 Worker 實時更新
- 避免不必要的輪詢

---

## 決策 3: JSON 展示方式

**日期**: 2026-01-29
**狀態**: 已決定

### 背景
工具調用的 Input/Output 是 JSON 對象，需要決定展示方式。

### 選項
1. **純文本**: JSON.stringify 直接顯示
2. **語法高亮**: 使用 highlight.js 等庫
3. **可交互樹**: 可折疊的樹狀結構

### 決定
選擇 **選項 1: 純文本 + 格式化**

### 理由
- 保持輕量，不引入額外依賴
- JSON.stringify(obj, null, 2) 已足夠可讀
- 未來可升級到語法高亮

---

## 決策 4: 消息歷史展示

**日期**: 2026-01-29
**狀態**: 已決定

### 背景
需要決定消息歷史的預設狀態。

### 決定
- 預設 **收起** 消息歷史
- 只顯示消息數量
- 點擊展開查看詳情

### 理由
- 消息可能很長，影響整體瀏覽
- 用戶通常先看工具調用，再看詳細對話
- 收起狀態保持界面整潔

---

## 決策 5: 組件命名規範

**日期**: 2026-01-29
**狀態**: 已決定

### 決定
- `WorkerHeader`: Worker 詳情標題欄
- `CurrentTask`: 當前任務描述
- `ToolCallItem`: 單個工具調用
- `ToolCallsPanel`: 工具調用面板
- `MessageHistory`: 對話歷史
- `CheckpointPanel`: 檢查點面板
- `WorkerDetailDrawer`: 主 Drawer 組件

### 理由
- 使用 "Panel" 表示可折疊區塊
- 使用 "Item" 表示列表項
- 使用 "Drawer" 表示滑出面板

---

## 待決定事項

### 問題 1: 思考過程面板
- **狀態**: 延遲至 Sprint 104
- **背景**: Extended Thinking 的展示需要特殊處理
- **暫定方案**: 預留接口，Sprint 104 實現

---

**最後更新**: 2026-01-29
