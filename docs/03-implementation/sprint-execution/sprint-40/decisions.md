# Sprint 40 Technical Decisions: Azure MCP Server

## 決策記錄

| ID | 決策 | 日期 | 狀態 |
|----|------|------|------|
| D40-1 | 使用 Azure SDK for Python | 2025-12-22 | ✅ 已採納 |
| D40-2 | 實現統一客戶端管理器 | 2025-12-22 | ✅ 已採納 |
| D40-3 | 工具分類按 Azure 服務類型 | 2025-12-22 | ✅ 已採納 |
| D40-4 | 實現三級權限控制 | 2025-12-22 | ✅ 已採納 |

---

## 決策詳情

### D40-1: 使用 Azure SDK for Python

**背景**: 需要選擇與 Azure 服務互動的方式

**選項**:
1. Azure SDK for Python - 官方 SDK
2. Azure REST API 直接調用
3. Azure CLI 包裝

**決策**: 使用 Azure SDK for Python

**理由**:
- 官方支援和維護
- 類型安全和自動完成
- 內建認證處理
- 與 DefaultAzureCredential 整合良好

---

### D40-2: 實現統一客戶端管理器

**背景**: 需要管理多個 Azure 服務客戶端

**選項**:
1. 每次調用創建新客戶端
2. 全局單例客戶端
3. 統一管理器模式 (AzureClientManager)

**決策**: 實現 AzureClientManager 統一管理

**理由**:
- 懶載入減少啟動時間
- 客戶端快取提高效率
- 統一的資源清理機制
- 易於擴展新服務支援

---

### D40-3: 工具分類按 Azure 服務類型

**背景**: 需要組織 23 個 Azure 工具

**選項**:
1. 單一工具文件
2. 按服務類型分類 (VM, Network, Storage...)
3. 按操作類型分類 (CRUD)

**決策**: 按 Azure 服務類型分類

**理由**:
- 與 Azure 服務架構對齊
- 易於維護和擴展
- 清晰的職責劃分
- 便於按需載入

---

### D40-4: 實現三級權限控制

**背景**: 需要控制不同工具的風險等級

**決策**: 實現三級權限 (L1, L2, L3)

| 等級 | 描述 | 工具範例 |
|------|------|----------|
| L1 (READ) | 唯讀操作 | list_vms, get_metrics |
| L2 (EXECUTE) | 執行操作 | start_vm, stop_vm |
| L3 (HIGH) | 高風險操作 | run_command |

**理由**:
- 符合最小權限原則
- 保護生產環境
- 便於審計和合規

---

**創建日期**: 2025-12-22
**更新日期**: 2025-12-22
