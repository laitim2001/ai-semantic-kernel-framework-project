# Sprint 89 技術決策記錄

## 決策列表

### D89-1: 統計數據計算位置

**決策**: 在前端從 TraceEvent[] 計算統計數據

**選項**:
1. 後端 API 提供預計算統計 (/api/v1/devtools/traces/{id}/statistics)
2. 前端從 TraceEvent[] 計算
3. 混合方式 - 簡單統計前端計算，複雜統計後端提供

**選擇**: 選項 2 - 前端計算

**理由**:
- 減少後端 API 開發工作
- 事件數據已經在前端，避免額外 API 調用
- 對於 DevUI 場景，事件數量通常不會太大
- 可以實現即時統計更新

---

### D89-2: SSE vs WebSocket

**決策**: 使用 Server-Sent Events (SSE) 進行實時追蹤

**選項**:
1. WebSocket 雙向通信
2. SSE 單向推送
3. 輪詢 (Polling)

**選擇**: 選項 2 - SSE

**理由**:
- 實時追蹤只需要服務器推送，不需要雙向通信
- SSE 更簡單，瀏覽器原生支持
- 自動重連機制
- 符合現有後端 AG-UI SSE 實現

---

### D89-3: 餅圖實現方式

**決策**: 使用純 CSS/SVG 實現餅圖，不引入圖表庫

**選項**:
1. 引入 Chart.js / Recharts
2. 純 CSS conic-gradient
3. 純 SVG 路徑

**選擇**: 選項 3 - 純 SVG

**理由**:
- 避免增加依賴
- SVG 可以精確控制樣式
- 與現有 Tailwind 設計系統一致
- 餅圖需求簡單，不需要複雜圖表庫

---

### D89-4: 過濾器狀態管理

**決策**: 使用 URL 參數同步過濾狀態

**選項**:
1. 純組件狀態 (useState)
2. URL 參數同步
3. 全局狀態 (Zustand)

**選擇**: 選項 2 - URL 參數

**理由**:
- 可以分享包含過濾條件的連結
- 瀏覽器前進/後退支持
- 刷新頁面保留過濾狀態
- 對於 DevUI 調試場景特別有用

---

**創建日期**: 2026-01-13
**更新日期**: 2026-01-13
