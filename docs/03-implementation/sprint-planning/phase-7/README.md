# Phase 7: AI è‡ªä¸»æ±ºç­–èƒ½åŠ›å¼·åŒ–

**Phase ç›®æ¨™**: ç‚º Phase 2 æ“´å±•åŠŸèƒ½å•Ÿç”¨çœŸæ­£çš„ LLM æ”¯æ´ï¼Œå¯¦ç¾çœŸæ­£çš„ AI è‡ªä¸»æ±ºç­–èƒ½åŠ›

**é–‹å§‹æ—¥æœŸ**: 2025-12-21
**é è¨ˆå®Œæˆæ—¥æœŸ**: TBD
**ç¸½é»æ•¸**: 58 Story Points

---

## èƒŒæ™¯

### å•é¡Œç™¼ç¾

åœ¨ UAT æ¸¬è©¦æº–å‚™éç¨‹ä¸­ï¼Œç™¼ç¾ Phase 2 æ“´å±•åŠŸèƒ½ï¼ˆTaskDecomposerã€AutonomousDecisionEngineã€TrialAndErrorEngineï¼‰é›–ç„¶è¨­è¨ˆæ”¯æ´ LLMï¼Œä½†åœ¨å¯¦éš›ä½¿ç”¨ä¸­ä¸¦æœªæ³¨å…¥ `llm_service`ï¼Œå°è‡´ï¼š

| çµ„ä»¶ | è¨­è¨ˆæ„åœ– | å¯¦éš›ç‹€æ…‹ | å½±éŸ¿ |
|------|----------|----------|------|
| TaskDecomposer | LLM æ™ºèƒ½åˆ†è§£ | è¦å‰‡å¼åˆ†è§£ | ç„¡æ³•ç†è§£è¤‡é›œä»»å‹™èªç¾© |
| AutonomousDecisionEngine | LLM æ±ºç­–åˆ†æ | æ•¸å­¸è©•åˆ†å…¬å¼ | ç„¡æ³•é€²è¡Œèªç¾©æ¨ç† |
| TrialAndErrorEngine | LLM éŒ¯èª¤å­¸ç¿’ | æ¨¡å¼åŒ¹é… | ç„¡æ³•ç†è§£éŒ¯èª¤ä¸Šä¸‹æ–‡ |
| DynamicPlanner | LLM å‹•æ…‹è¦åŠƒ | è¦å‰‡å¼è¦åŠƒ | ç„¡æ³•é©æ‡‰è¤‡é›œå ´æ™¯ |

### æ ¸å¿ƒå•é¡Œ

```python
# PlanningAdapter ç•¶å‰ä»£ç¢¼ (planning.py:296-299)
self._task_decomposer = TaskDecomposer(
    max_subtasks=max_subtasks,
    max_depth=max_depth,
)  # âŒ æ²’æœ‰ llm_service æ³¨å…¥!
```

### å½±éŸ¿åˆ†æ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               ç¾ç‹€ vs ç›®æ¨™å°æ¯”                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ç¾ç‹€ (è¦å‰‡å¼)                 ç›®æ¨™ (AI è‡ªä¸»)            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”‚
â”‚  if task.contains("api"):      LLM åˆ†æä»»å‹™èªç¾©          â”‚
â”‚      subtasks = [api_tasks]    â†’ ç†è§£ä¸Šä¸‹æ–‡ä¾è³´          â”‚
â”‚                                â†’ æ™ºèƒ½åˆ†è§£ç­–ç•¥            â”‚
â”‚                                â†’ å‹•æ…‹èª¿æ•´è¨ˆåŠƒ            â”‚
â”‚                                                         â”‚
â”‚  result = score * weight       LLM è©•ä¼°æ±ºç­–              â”‚
â”‚                                â†’ è€ƒæ…®é¢¨éšªå› ç´             â”‚
â”‚                                â†’ è§£é‡‹æ±ºç­–ç†ç”±            â”‚
â”‚                                â†’ é æ¸¬æ½›åœ¨å•é¡Œ            â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Sprint æ¦‚è¦½

### Sprint 34: LLM æœå‹™åŸºç¤è¨­æ–½ (20 pts)
**ç›®æ¨™**: å‰µå»ºçµ±ä¸€çš„ LLM æœå‹™å±¤ï¼Œæ”¯æ´ Azure OpenAI æ•´åˆ

| Story | é»æ•¸ | èªªæ˜ | å„ªå…ˆç´š |
|-------|------|------|--------|
| S34-1 | 8 | LLMService æ¥å£å’Œ Azure OpenAI å¯¦ç¾ | ğŸ”´ P0 |
| S34-2 | 5 | LLM æœå‹™å·¥å» å’Œé…ç½®ç®¡ç† | ğŸ”´ P0 |
| S34-3 | 4 | LLM æœå‹™å–®å…ƒæ¸¬è©¦ | ğŸŸ¡ P1 |
| S34-4 | 3 | é…ç½®æ–‡ä»¶å’Œç’°å¢ƒè®Šé‡æ›´æ–° | ğŸŸ¡ P1 |

### Sprint 35: Phase 2 æ“´å±• LLM æ•´åˆ (23 pts)
**ç›®æ¨™**: å°‡ LLM æœå‹™æ³¨å…¥æ‰€æœ‰ Phase 2 æ“´å±•çµ„ä»¶

| Story | é»æ•¸ | èªªæ˜ | å„ªå…ˆç´š |
|-------|------|------|--------|
| S35-1 | 8 | PlanningAdapter LLM æ•´åˆ | ğŸ”´ P0 |
| S35-2 | 5 | TaskDecomposer LLM å•Ÿç”¨ | ğŸ”´ P0 |
| S35-3 | 5 | DecisionEngine LLM å•Ÿç”¨ | ğŸ”´ P0 |
| S35-4 | 5 | TrialAndErrorEngine LLM å•Ÿç”¨ | ğŸŸ¡ P1 |

### Sprint 36: é©—è­‰èˆ‡å„ªåŒ– (15 pts)
**ç›®æ¨™**: å®Œæ•´æ¸¬è©¦ AI è‡ªä¸»æ±ºç­–èƒ½åŠ›ï¼Œå„ªåŒ–æ€§èƒ½

| Story | é»æ•¸ | èªªæ˜ | å„ªå…ˆç´š |
|-------|------|------|--------|
| S36-1 | 5 | ç«¯åˆ°ç«¯ AI æ±ºç­–æ¸¬è©¦ | ğŸ”´ P0 |
| S36-2 | 5 | æ€§èƒ½åŸºæº–æ¸¬è©¦èˆ‡å„ªåŒ– | ğŸŸ¡ P1 |
| S36-3 | 3 | æ–‡æª”æ›´æ–°å’Œ UAT æº–å‚™ | ğŸŸ¡ P1 |
| S36-4 | 2 | LLM å›é€€ç­–ç•¥é©—è­‰ | ğŸŸ¢ P2 |

---

## æŠ€è¡“è¨­è¨ˆ

### LLM æœå‹™æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LLM Service Layer                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              LLMServiceProtocol                  â”‚   â”‚
â”‚  â”‚  + generate(prompt, max_tokens) -> str          â”‚   â”‚
â”‚  â”‚  + generate_structured(prompt, schema) -> dict  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†‘                              â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚           â”‚              â”‚              â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚AzureOpenAILLM  â”‚ â”‚MockLLM   â”‚ â”‚CachedLLM   â”‚      â”‚
â”‚  â”‚Service         â”‚ â”‚Service   â”‚ â”‚Service     â”‚      â”‚
â”‚  â”‚                â”‚ â”‚(Testing) â”‚ â”‚(Production)â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Phase 2 Extensions                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  PlanningAdapter                                        â”‚
â”‚  â”œâ”€â”€ _llm_service: LLMService      â† æ–°å¢              â”‚
â”‚  â”œâ”€â”€ _magentic_builder             (ç¾æœ‰)              â”‚
â”‚  â”œâ”€â”€ _task_decomposer(llm_service) â† æ³¨å…¥ LLM          â”‚
â”‚  â”œâ”€â”€ _decision_engine(llm_service) â† æ³¨å…¥ LLM          â”‚
â”‚  â””â”€â”€ _trial_error(llm_service)     â† æ³¨å…¥ LLM          â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä»£ç¢¼ä¿®æ”¹é è¦½

```python
# ç›®æ¨™ä»£ç¢¼ (Sprint 35 å®Œæˆå¾Œ)

class PlanningAdapter:
    def __init__(
        self,
        id: str,
        config: Optional[PlanningConfig] = None,
        llm_service: Optional[LLMServiceProtocol] = None,  # æ–°å¢
    ):
        self._id = id
        self._config = config or PlanningConfig()

        # å®˜æ–¹ Builder å¯¦ä¾‹
        self._magentic_builder = MagenticBuilder()

        # LLM æœå‹™ (ç”¨æ–¼ Phase 2 æ“´å±•)
        self._llm_service = llm_service or LLMServiceFactory.create()

        # Phase 2 æ“´å±•åŠŸèƒ½ - ç¾åœ¨å¸¶ LLM!
        self._task_decomposer: Optional[TaskDecomposer] = None
        self._decision_engine: Optional[AutonomousDecisionEngine] = None
        self._trial_error_engine: Optional[TrialAndErrorEngine] = None

    def with_task_decomposition(
        self,
        strategy: DecompositionStrategy = DecompositionStrategy.HYBRID,
        max_subtasks: Optional[int] = None,
        max_depth: Optional[int] = None,
    ) -> "PlanningAdapter":
        self._task_decomposer = TaskDecomposer(
            llm_service=self._llm_service,  # âœ… æ³¨å…¥ LLM
            max_subtasks=max_subtasks or self._config.max_subtasks,
            max_depth=max_depth or self._config.max_depth,
        )
        self._mode = PlanningMode.DECOMPOSED
        return self
```

---

## æˆåŠŸæ¨™æº–

### æŠ€è¡“æ¨™æº–
- [ ] LLMService æ¥å£å®šç¾©å®Œæˆ
- [ ] Azure OpenAI å¯¦ç¾é€šéæ¸¬è©¦
- [ ] æ‰€æœ‰ Phase 2 æ“´å±•æ¥æ”¶ `llm_service` æ³¨å…¥
- [ ] LLM èª¿ç”¨æ­£ç¢ºè§¸ç™¼ï¼ˆéè¦å‰‡å¼å¾Œå‚™ï¼‰
- [ ] å›é€€æ©Ÿåˆ¶æ­£å¸¸å·¥ä½œï¼ˆLLM ä¸å¯ç”¨æ™‚ï¼‰

### åŠŸèƒ½æ¨™æº–
- [ ] TaskDecomposer ä½¿ç”¨ LLM é€²è¡Œèªç¾©åˆ†è§£
- [ ] DecisionEngine ä½¿ç”¨ LLM é€²è¡Œæ±ºç­–åˆ†æ
- [ ] TrialAndErrorEngine ä½¿ç”¨ LLM é€²è¡ŒéŒ¯èª¤å­¸ç¿’
- [ ] ç«¯åˆ°ç«¯ AI è‡ªä¸»æ±ºç­–æµç¨‹å¯é©—è­‰

### è³ªé‡æ¨™æº–
- [ ] æ–°å¢æ¸¬è©¦ > 30 å€‹
- [ ] æ¸¬è©¦è¦†è“‹ç‡ç¶­æŒ 85%+
- [ ] LLM èª¿ç”¨å»¶é² < 5 ç§’ (P95)
- [ ] ç„¡å›æ­¸éŒ¯èª¤

---

## é¢¨éšªèˆ‡ç·©è§£

| é¢¨éšª | å¯èƒ½æ€§ | å½±éŸ¿ | ç·©è§£æªæ–½ |
|------|--------|------|---------|
| Azure OpenAI API é…é¡é™åˆ¶ | ä¸­ | é«˜ | å¯¦ç¾ Token é ç®—ç®¡ç†ã€ç·©å­˜æ©Ÿåˆ¶ |
| LLM å›æ‡‰å»¶é²éé«˜ | ä¸­ | ä¸­ | å¯¦ç¾è¶…æ™‚æ©Ÿåˆ¶ã€ä¸¦è¡Œè™•ç†ã€ç·©å­˜ |
| LLM è¼¸å‡ºæ ¼å¼ä¸ç©©å®š | ä¸­ | ä¸­ | çµæ§‹åŒ–è¼¸å‡ºã€JSON Schema é©—è­‰ |
| æ¸¬è©¦ç’°å¢ƒ LLM è²»ç”¨ | ä½ | ä½ | ä½¿ç”¨ Mock LLM é€²è¡Œå–®å…ƒæ¸¬è©¦ |
| å‘å¾Œå…¼å®¹æ€§å•é¡Œ | ä½ | ä¸­ | ä¿æŒè¦å‰‡å¼å¾Œå‚™ä½œç‚º fallback |

---

## ç›¸é—œæ–‡ä»¶

- [Phase 6 å®Œæˆå ±å‘Š](../phase-6/README.md)
- [Sprint 34 è©³ç´°è¨ˆåŠƒ](./sprint-34-plan.md)
- [Sprint 35 è©³ç´°è¨ˆåŠƒ](./sprint-35-plan.md)
- [Sprint 36 è©³ç´°è¨ˆåŠƒ](./sprint-36-plan.md)
- [Phase 2 æ“´å±•è¨­è¨ˆæ–‡æª”](../../sprint-execution/sprint-10/decisions.md)

---

## ä¾è³´é …

### å‰ç½®æ¢ä»¶
- âœ… Phase 6 å®Œæˆ (æ¶æ§‹æ”¶å°¾)
- âœ… PlanningAdapter å·²å‰µå»º
- âœ… Phase 2 æ“´å±•çµ„ä»¶å·²å­˜åœ¨
- â³ Azure OpenAI é…ç½®å¯ç”¨

### å¤–éƒ¨ä¾è³´
- Azure OpenAI API (GPT-4o éƒ¨ç½²)
- openai Python SDK >= 1.0.0

---

## å…¨é …ç›®ç¸½çµ (Phase 7 å¾Œ)

| Phase | Sprint ç¯„åœ | é»æ•¸ | ç‹€æ…‹ |
|-------|-------------|------|------|
| Phase 1 | Sprint 0-6 | 285 pts | âœ… å®Œæˆ |
| Phase 2 | Sprint 7-12 | 222 pts | âœ… å®Œæˆ |
| Phase 3 | Sprint 13-19 | 242 pts | âœ… å®Œæˆ |
| Phase 4 | Sprint 20-25 | 180 pts | âœ… å®Œæˆ |
| Phase 5 | Sprint 26-30 | 183 pts | âœ… å®Œæˆ |
| Phase 6 | Sprint 31-33 | 78 pts | âœ… å®Œæˆ |
| **Phase 7** | **Sprint 34-36** | **58 pts** | â³ é€²è¡Œä¸­ |
| **ç¸½è¨ˆ** | **36 Sprints** | **1248 pts** | - |

---

**å‰µå»ºæ—¥æœŸ**: 2025-12-21
**ä¸Šæ¬¡æ›´æ–°**: 2025-12-21
